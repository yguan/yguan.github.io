define(["require","exports","module","data/idb","data/tag-group-repository","data/bookmark-repository","data/chrome-bookmark-parser"],function(e,t,n){function u(e,t){var n=o.parseChromeBookmarks(e),r=n.bookmarks;_.each(r,function(e){e.tags=_.map(e.tags,function(e){return e.toLowerCase()}),e.dateAdded=new Date(e.dateAdded)}),s.addAll(r,t)}var r=e("data/idb"),i=e("data/tag-group-repository"),s=e("data/bookmark-repository"),o=e("data/chrome-bookmark-parser");t.init=function(e){r.loadIndexedDB({success:function(){i.loadAllTagsToCache(e)}})},t.loadChromeBookmarks=function(e,t){u(e,t)},t.loadBookmarksFromChrome=function(e){chrome.bookmarks.getTree(function(t){u(t[0].children,e)})}});
var dimple={version:"1.0.0",plot:{},aggregateMethod:{}};!function(){"use strict";dimple.axis=function(t,e,i,s,r){this.chart=t,this.position=e,this.categoryFields=null===r||void 0===r?i:[].concat(r),this.measure=s,this.timeField=r,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getFormat=function(){var t,e,i,s,r,a,l;return null!==this.tickFormat&&void 0!==this.tickFormat?t=this._hasTimeField()?d3.time.format(this.tickFormat):d3.format(this.tickFormat):this.showPercent?t=d3.format("%"):this.useLog&&null!==this.measure?t=function(t){var e=Math.floor(Math.abs(t),0).toString().length,i=Math.min(Math.floor((e-1)/3),4),s="kmBT".substring(i-1,i),r="0"===Math.round(t/Math.pow(1e3,i)*10).toString().slice(-1)?0:1;return 0===t?0:d3.format(",."+r+"f")(t/Math.pow(1e3,i))+s}:null!==this.measure?(e=Math.floor(Math.abs(this._max),0).toString(),i=Math.floor(Math.abs(this._min),0).toString(),s=Math.max(i.length,e.length),s>3?(r=Math.min(Math.floor((s-1)/3),4),a="kmBT".substring(r-1,r),l=1>=s-3*r?1:0,t=function(t){return 0===t?0:d3.format(",."+l+"f")(t/Math.pow(1e3,r))+a}):(l=1>=s?1:0,t=d3.format(",."+l+"f"))):t=function(t){return t},t},this._getTimePeriod=function(){var t=this.timePeriod,e=30,i=this._max-this._min;return!this._hasTimeField||null!==this.timePeriod&&void 0!==this.timePeriod||(t=e>=i/1e3?d3.time.seconds:e>=i/6e4?d3.time.minutes:e>=i/36e5?d3.time.hours:e>=i/864e5?d3.time.days:e>=i/6048e5?d3.time.weeks:e>=i/26298e5?d3.time.months:d3.time.years),t},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(t){return null===this.dateParseFormat||void 0===this.dateParseFormat?Date.parse(t):d3.time.format(this.dateParseFormat).parse(t)},this._update=function(t){var e,i,s,r=[],a=function(t,e,i){var s,r=t.categoryFields[0],a=r,l=!1,n=!0,o=[];for(s=0;s<t.chart.data.length;s+=1)if(isNaN(t._parseDate(t.chart.data[s][r]))){n=!1;break}return n||t.chart.series.forEach(function(s){s[e]===t&&s[i]._hasMeasure()&&(a=s[i].measure,l=!0)},this),o=t._orderRules.concat({ordering:a,desc:l}),dimple._getOrderedList(t.chart.data,r,o)};if(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&this._max>1?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,"x"===this.position){if(this._hasTimeField()?this._scale=d3.time.scale().rangeRound([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]):this.useLog?this._scale=d3.scale.log().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(!0).base(this.logBase).nice():null===this.measure||void 0===this.measure?(r=a(this,"x","y"),this._scale=d3.scale.ordinal().rangePoints([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(r.concat([""]))):this._scale=d3.scale.linear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).nice(),!this.hidden)switch(this.chart._axisIndex(this,"x")){case 0:this._draw=d3.svg.axis().orient("bottom").scale(this._scale);break;case 1:this._draw=d3.svg.axis().orient("top").scale(this._scale)}}else if("y"===this.position){if(this._hasTimeField()?this._scale=d3.time.scale().rangeRound([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]):this.useLog?this._scale=d3.scale.log().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(!0).base(this.logBase).nice():null===this.measure||void 0===this.measure?(r=a(this,"y","x"),this._scale=d3.scale.ordinal().rangePoints([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(r.concat([""]))):this._scale=d3.scale.linear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).nice(),!this.hidden)switch(this.chart._axisIndex(this,"y")){case 0:this._draw=d3.svg.axis().orient("left").scale(this._scale);break;case 1:this._draw=d3.svg.axis().orient("right").scale(this._scale)}}else this.position.length>0&&"z"===this.position[0]?this._scale=this.useLog?d3.scale.log().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(!0).base(this.logBase):d3.scale.linear().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([this._min,this._max]):this.position.length>0&&"c"===this.position[0]&&(this._scale=d3.scale.linear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]));return null!==t&&void 0!==t&&!1!==t||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(this._scale.ticks(10).length>0)||"x"!==this.position&&"y"!==this.position||(e=this._scale.ticks(10),i=e[1]-e[0],0!==((this._max-this._min)%i).toFixed(0)&&(this._max=Math.ceil(this._max/i)*i,this._min=Math.floor(this._min/i)*i,this._update(!0))),s=this._scale.copy()(0),this._origin!==s&&(this._previousOrigin=null===this._origin?s:this._origin,this._origin=s),this},this.addGroupOrderRule=function(t,e){this._groupOrderRules.push({ordering:t,desc:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})}},dimple.chart=function(t,e){this.svg=t,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=e,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this._group=t.append("g"),this._tooltipGroup=null,this._assignedColors={},this._nextColor=0,this._axisIndex=function(t,e){var i=0,s=0,r=-1;for(i=0;i<this.axes.length;i+=1){if(this.axes[i]===t){r=s;break}(null===e||void 0===e||e[0]===this.axes[i].position[0])&&(s+=1)}return r},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach(function(t){var e,i,s=[],r=function(t,e){var i=[];return null!==t&&(t._hasTimeField()?i.push(t._parseDate(e[t.timeField])):t._hasCategories()&&t.categoryFields.forEach(function(t){i.push(e[t])},this)),i},a={x:!1,y:!1,z:!1,c:!1},l={x:[],y:[]},n={x:[],y:[],z:[]},o={min:null,max:null},h={x:[],y:[],z:[]},d=[],u={},c={x:0,y:0,z:0},p="",g=[],x="",y=[],_="",f=[],m="",v=[],F=[],w=this.data,b=[];null!==this.storyboard&&void 0!==this.storyboard&&this.storyboard.categoryFields.length>0&&(p=this.storyboard.categoryFields[0],g=dimple._getOrderedList(this.data,p,this.storyboard._orderRules)),t.x._hasCategories()&&t.x._hasMeasure()&&(_=t.x.categoryFields[0],f=dimple._getOrderedList(this.data,_,t.x._orderRules.concat([{ordering:t.x.measure,desc:!0}]))),t.y._hasCategories()&&t.y._hasMeasure()&&(m=t.y.categoryFields[0],v=dimple._getOrderedList(this.data,m,t.y._orderRules.concat([{ordering:t.y.measure,desc:!0}]))),null!==t.categoryFields&&void 0!==t.categoryFields&&t.categoryFields.length>0&&(F=[].concat(t._orderRules),x=t.categoryFields[0],null!==t.c&&void 0!==t.c&&t.c._hasMeasure()?F.push({ordering:t.c.measure,desc:!0}):null!==t.z&&void 0!==t.z&&t.z._hasMeasure()?F.push({ordering:t.z.measure,desc:!0}):t.x._hasMeasure()?F.push({ordering:t.x.measure,desc:!0}):t.y._hasMeasure()&&F.push({ordering:t.y.measure,desc:!0}),y=dimple._getOrderedList(this.data,x,F)),w.sort(function(t,e){var i=0;return""!==p&&(i=g.indexOf(t[p])-g.indexOf(e[p])),""!==_&&0===i&&(i=f.indexOf(t[_])-f.indexOf(e[_])),""!==m&&0===i&&(i=v.indexOf(t[m])-v.indexOf(e[m])),""!==x&&0===i&&(i=y.indexOf(t[x])-y.indexOf(e[x])),i}),w.forEach(function(e){var i,l,n,o,h=-1,d=r(t.x,e),u=r(t.y,e),c=r(t.z,e),p=[];for(null===t.categoryFields||void 0===t.categoryFields||0===t.categoryFields.length?p=["All"]:1===t.categoryFields.length&&void 0===e[t.categoryFields[0]]?p=[t.categoryFields[0]]:t.categoryFields.forEach(function(t){p.push(e[t])},this),i=p.join("/")+"_"+d.join("/")+"_"+u.join("/")+"_"+c.join("/"),l=0;l<s.length;l+=1)if(s[l].key===i){h=l;break}-1===h&&(n={key:i,aggField:p,xField:d,xValue:null,xCount:0,yField:u,yValue:null,yCount:0,zField:c,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],cValueList:[],fill:{},stroke:{}},s.push(n),h=s.length-1),o=function(i,r){var l,n,o=!0,d={value:0,count:1},u={value:0,count:1},c="";null!==r&&(l=r.getFrameValue(),r.categoryFields.forEach(function(t,i){i>0&&(c+="/"),c+=e[t],o=c===l},this)),null!==i&&void 0!==i&&o&&(n=s[h],i._hasMeasure()&&(void 0===e[i.measure]&&(e[i.measure]=0),-1===n[i.position+"ValueList"].indexOf(e[i.measure])&&n[i.position+"ValueList"].push(e[i.measure]),isNaN(parseFloat(e[i.measure]))&&(a[i.position]=!0),d.value=n[i.position+"Value"],d.count=n[i.position+"Count"],u.value=e[i.measure],n[i.position+"Value"]=t.aggregate(d,u),n[i.position+"Count"]+=1))},o(t.x,this.storyboard),o(t.y,this.storyboard),o(t.z,this.storyboard),o(t.c,this.storyboard)},this),null!==t.x&&void 0!==t.x&&t.x._hasCategories()&&t.x.categoryFields.length>1&&void 0!==l.x&&(b=[],t.y._hasMeasure()&&b.push({ordering:t.y.measure,desc:!0}),l.x=dimple._getOrderedList(this.data,t.x.categoryFields[1],t.x._groupOrderRules.concat(b))),null!==t.y&&void 0!==t.y&&t.y._hasCategories()&&t.y.categoryFields.length>1&&void 0!==l.y&&(b=[],t.x._hasMeasure()&&b.push({ordering:t.x.measure,desc:!0}),l.y=dimple._getOrderedList(this.data,t.y.categoryFields[1],t.y._groupOrderRules.concat(b)),l.y.reverse()),s.forEach(function(i){null!==t.x&&(!0===a.x&&(i.xValue=i.xValueList.length),e=(null===n.x[i.xField.join("/")]||void 0===n.x[i.xField.join("/")]?0:n.x[i.xField.join("/")])+(t.y._hasMeasure()?Math.abs(i.yValue):0),n.x[i.xField.join("/")]=e),null!==t.y&&(!0===a.y&&(i.yValue=i.yValueList.length),e=(null===n.y[i.yField.join("/")]||void 0===n.y[i.yField.join("/")]?0:n.y[i.yField.join("/")])+(t.x._hasMeasure()?Math.abs(i.xValue):0),n.y[i.yField.join("/")]=e),null!==t.z&&(!0===a.z&&(i.zValue=i.zValueList.length),e=(null===n.z[i.zField.join("/")]||void 0===n.z[i.zField.join("/")]?0:n.z[i.zField.join("/")])+(t.z._hasMeasure()?Math.abs(i.zValue):0),n.z[i.zField.join("/")]=e),null!==t.c&&((null===o.min||i.cValue<o.min)&&(o.min=i.cValue),(null===o.max||i.cValue>o.max)&&(o.max=i.cValue))},this);for(i in n.x)n.x.hasOwnProperty(i)&&(c.x+=n.x[i]);for(i in n.y)n.y.hasOwnProperty(i)&&(c.y+=n.y[i]);for(i in n.z)n.z.hasOwnProperty(i)&&(c.z+=n.z[i]);s.forEach(function(e){var i,s,r,a,p,g=function(i,s,r){var a,o,p,g,x;null!==i&&void 0!==i&&(g=i.position,i._hasCategories()?i._hasMeasure()?(a=e[i.position+"Field"].join("/"),o=i.showPercent?n[i.position][a]/c[i.position]:n[i.position][a],-1===d.indexOf(a)&&(u[a]=o+(d.length>0?u[d[d.length-1]]:0),d.push(a)),p=e[g+"Bound"]=e["c"+g]="x"!==g&&"y"!==g||!t.stacked?o:u[a],e[r]=o,e[g]=p-("x"===g&&o>=0||"y"===g&&0>=o?o:0)):(e[g]=e["c"+g]=e[g+"Field"][0],e[r]=1,void 0!==l[g]&&null!==l[g]&&l[g].length>=2&&(e[g+"Offset"]=l[g].indexOf(e[g+"Field"][1]),e[r]=1/l[g].length)):(o=i.showPercent?e[g+"Value"]/n[s][e[s+"Field"].join("/")]:e[g+"Value"],a=e[s+"Field"].join("/")+(e[g+"Value"]>=0),x=h[g][a]=(null===h[g][a]||void 0===h[g][a]||"z"===g?0:h[g][a])+o,p=e[g+"Bound"]=e["c"+g]="x"!==g&&"y"!==g||!t.stacked?o:x,e[r]=o,e[g]=p-("x"===g&&o>=0||"y"===g&&0>=o?o:0)))};g(t.x,"y","width"),g(t.y,"x","height"),g(t.z,"z","r"),null!==t.c&&null!==o.min&&null!==o.max&&(o.min===o.max&&(o.min-=.5,o.max+=.5),o.min=null!==t.c.overrideMin&&void 0!==t.c.overrideMin?t.c.overrideMin:o.min,o.max=null!==t.c.overrideMax&&void 0!==t.c.overrideMax?t.c.overrideMax:o.max,e.cValue=e.cValue>o.max?o.max:e.cValue<o.min?o.min:e.cValue,r=d3.scale.linear().range([0,null===t.c.colors||1===t.c.colors.length?1:t.c.colors.length-1]).domain([o.min,o.max]),a=r(e.cValue),p=a-Math.floor(a),e.cValue===o.max&&(p=1),null!==t.c.colors&&void 0!==t.c.colors&&1===t.c.colors.length?(i=d3.rgb(t.c.colors[0]),s=d3.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)):null!==t.c.colors&&void 0!==t.c.colors&&t.c.colors.length>1?(i=d3.rgb(t.c.colors[Math.floor(a)]),s=d3.rgb(t.c.colors[Math.ceil(a)])):(i=d3.rgb("white"),s=d3.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)),i.r=Math.floor(i.r+(s.r-i.r)*p),i.g=Math.floor(i.g+(s.g-i.g)*p),i.b=Math.floor(i.b+(s.b-i.b)*p),e.fill=i.toString(),e.stroke=i.darker(.5).toString())},this),t._positionData=s},this)},this._heightPixels=function(){return dimple._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(t){null!==t._eventHandlers&&t._eventHandlers.length>0&&t._eventHandlers.forEach(function(e){null!==e.handler&&"function"==typeof e.handler&&t.shapes.on(e.event,function(i){var s=new dimple.eventArgs;null!==t.chart.storyboard&&(s.frameValue=t.chart.storyboard.getFrameValue()),s.seriesValue=i.aggField,s.xValue=i.x,s.yValue=i.y,s.zValue=i.z,s.colorValue=i.cValue,s.seriesShapes=t.shapes,s.selectedShape=d3.select(this),e.handler(s)})},this)},this._widthPixels=function(){return dimple._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return dimple._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return dimple._parseYPosition(this.y,this.svg.node())},this.addAxis=function(t,e,i,s){null!==e&&void 0!==e&&(e=[].concat(e));var r=new dimple.axis(this,t,e,i,s);return this.axes.push(r),r},this.addCategoryAxis=function(t,e){return this.addAxis(t,e,null)},this.addColorAxis=function(t,e){var i=this.addAxis("c",null,t);return i.colors=null===e||void 0===e?null:[].concat(e),i},this.addLegend=function(t,e,i,s,r,a){a=null===a||void 0===a?this.series:[].concat(a),r=null===r||void 0===r?"left":r;var l=new dimple.legend(this,t,e,i,s,r,a);return this.legends.push(l),l},this.addLogAxis=function(t,e,i){var s=this.addAxis(t,null,e,null);return null!==i&&void 0!==i&&(s.logBase=i),s.useLog=!0,s},this.addMeasureAxis=function(t,e){return this.addAxis(t,null,e)},this.addPctAxis=function(t,e,i){var s=null;return s=null!==i&&void 0!==i?this.addAxis(t,i,e):this.addMeasureAxis(t,e),s.showPercent=!0,s},this.addSeries=function(t,e,i){(null===i||void 0===i)&&(i=this.axes),(null===e||void 0===e)&&(e=dimple.plot.bubble);var s,r=null,a=null,l=null,n=null;return i.forEach(function(t){null!==t&&e.supportedAxes.indexOf(t.position)>-1&&(null===r&&"x"===t.position[0]?r=t:null===a&&"y"===t.position[0]?a=t:null===l&&"z"===t.position[0]?l=t:null===n&&"c"===t.position[0]&&(n=t))},this),null!==t&&void 0!==t&&(t=[].concat(t)),s=new dimple.series(this,t,r,a,l,n,e,dimple.aggregateMethod.sum,e.stacked),this.series.push(s),s},this.addTimeAxis=function(t,e,i,s){var r=this.addAxis(t,null,null,e);return r.tickFormat=s,r.dateParseFormat=i,r},this.assignColor=function(t,e,i,s){return this._assignedColors[t]=new dimple.color(e,i,s),this._assignedColors[t]},this.defaultColors=[new dimple.color("#80B1D3"),new dimple.color("#FB8072"),new dimple.color("#FDB462"),new dimple.color("#B3DE69"),new dimple.color("#FFED6F"),new dimple.color("#BC80BD"),new dimple.color("#8DD3C7"),new dimple.color("#CCEBC5"),new dimple.color("#FFFFB3"),new dimple.color("#BEBADA"),new dimple.color("#FCCDE5"),new dimple.color("#D9D9D9")],this.draw=function(t,e){t=null===t||void 0===t?0:t;var i,s=null,r=null,a=!1,l=!1,n=this._xPixels(),o=this._yPixels(),h=this._widthPixels(),d=this._heightPixels();return(void 0===e||null===e||!1===e)&&this._getSeriesData(),this.axes.forEach(function(t){if(t._min=0,t._max=0,t._hasMeasure()){var e=!1;this.series.forEach(function(i){if(i[t.position]===t){var s=i._axisBounds(t.position);t._min>s.min&&(t._min=s.min),t._max<s.max&&(t._max=s.max),e=!0}},this),e||this.data.forEach(function(e){t._min>e[t.measure]&&(t._min=e[t.measure]),t._max<e[t.measure]&&(t._max=e[t.measure])},this)}else t._hasTimeField()?(t._min=null,t._max=null,this.data.forEach(function(e){var i=t._parseDate(e[t.timeField]);(null===t._min||i<t._min)&&(t._min=i),(null===t._max||i>t._max)&&(t._max=i)},this)):t._hasCategories()&&(t._min=0,i=[],this.data.forEach(function(e){-1===i.indexOf(e[t.categoryFields[0]])&&i.push(e[t.categoryFields[0]])},this),t._max=i.length);t._update(),null===s&&"x"===t.position?s=t:null===r&&"y"===t.position&&(r=t)},this),this.axes.forEach(function(e){var i,u=!1,c=null,p=0,g=null,x=!1,y=0,_={l:null,t:null,r:null,b:null},f=0,m=0,v="",F=this;null===e.gridlineShapes?(e.showGridlines||null===e.showGridlines&&!e._hasCategories()&&(!a&&"x"===e.position||!l&&"y"===e.position))&&(e.gridlineShapes=this._group.append("g").attr("class","gridlines"),"x"===e.position?a=!0:l=!0):"x"===e.position?a=!0:l=!0,null===e.shapes&&(e.shapes=this._group.append("g").attr("class","axis"),u=!0),e===s&&null!==r?(c="translate(0, "+(null===r.categoryFields||0===r.categoryFields.length?r._scale(0):o+d)+")",g="translate(0, "+(e===s?o+d:o)+")",p=-d):e===r&&null!==s?(c="translate("+(null===s.categoryFields||0===s.categoryFields.length?s._scale(0):n)+", 0)",g="translate("+(e===r?n:n+h)+", 0)",p=-h):"x"===e.position?(g=c="translate(0, "+(e===s?o+d:o)+")",p=-d):"y"===e.position&&(g=c="translate("+(e===r?n:n+h)+", 0)",p=-h),i=function(e){return null===c||0===t||u?e:e.transition().duration(t)},null!==c&&null!==e._draw&&(e._hasTimeField()?i(e.shapes).call(e._draw.ticks(e._getTimePeriod(),e.timeInterval).tickFormat(e._getFormat())).attr("transform",c):e.useLog?i(e.shapes).call(e._draw.ticks(4,e._getFormat())).attr("transform",c):i(e.shapes).call(e._draw.tickFormat(e._getFormat())).attr("transform",c),null!==e.gridlineShapes&&i(e.gridlineShapes).call(e._draw.tickSize(p,0,0).tickFormat("")).attr("transform",g),(null===e.measure||void 0===e.measure)&&("x"===e.position?i(e.shapes.selectAll("text")).attr("x",h/e._max/2):"y"===e.position&&i(e.shapes.selectAll("text")).attr("y",d/e._max*-1/2)),null!==e.categoryFields&&void 0!==e.categoryFields&&e.categoryFields.length>0&&(e!==s||null!==r.categoryFields&&0!==r.categoryFields.length||i(e.shapes.selectAll("text")).attr("y",o+d-r._scale(0)+9),e!==r||null!==s.categoryFields&&0!==s.categoryFields.length||i(e.shapes.selectAll("text")).attr("x",-1*(s._scale(0)-n)-9))),this.noFormats||(i(e.shapes.selectAll("text")).style("font-family","sans-serif").style("font-size",(d/35>10?d/35:10)+"px"),i(e.shapes.selectAll("path, line")).style("fill","none").style("stroke","black").style("shape-rendering","crispEdges"),null!==e.gridlineShapes&&i(e.gridlineShapes.selectAll("line")).style("fill","none").style("stroke","lightgray").style("opacity",.8)),(null===e.measure||void 0===e.measure)&&(e===s?(y=0,e.shapes.selectAll("text").each(function(){var t=this.getComputedTextLength();y=t>y?t:y}),y>h/e.shapes.selectAll("text")[0].length?(x=!0,e.shapes.selectAll("text").style("text-anchor","start").each(function(){var t=this.getBBox();d3.select(this).attr("transform","rotate(90,"+t.x+","+(t.y+t.height/2)+") translate(-5, 0)")})):(x=!1,e.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===e.position&&(y=0,e.shapes.selectAll("text").each(function(){var t=this.getComputedTextLength();y=t>y?t:y}),y>h/e.shapes.selectAll("text")[0].length?(x=!0,e.shapes.selectAll("text").style("text-anchor","end").each(function(){var t=this.getBBox();d3.select(this).attr("transform","rotate(90,"+(t.x+t.width)+","+(t.y+t.height/2)+") translate(5, 0)")})):(x=!1,e.shapes.selectAll("text").style("text-anchor","middle").attr("transform","")))),null!==e.titleShape&&void 0!==e.titleShape&&e.titleShape.remove(),e.shapes.selectAll("text").each(function(){var t=this.getBBox();(null===_.l||-9-t.width<_.l)&&(_.l=-9-t.width),(null===_.r||t.x+t.width>_.r)&&(_.r=t.x+t.width),x?((null===_.t||t.y+t.height-t.width<_.t)&&(_.t=t.y+t.height-t.width),(null===_.b||t.height+t.width>_.b)&&(_.b=t.height+t.width)):((null===_.t||t.y<_.t)&&(_.t=t.y),(null===_.b||9+t.height>_.b)&&(_.b=9+t.height))}),"x"===e.position?(m=e===s?o+d+_.b+5:o+_.t-10,f=n+h/2):"y"===e.position&&(f=e===r?n+_.l-10:n+h+_.r+20,m=o+d/2,v="rotate(270, "+f+", "+m+")"),e.hidden||"x"!==e.position&&"y"!==e.position||(e.titleShape=this._group.append("text").attr("class","axis title"),e.titleShape.attr("x",f).attr("y",m).attr("text-anchor","middle").attr("transform",v).text(null===e.categoryFields||void 0===e.categoryFields||0===e.categoryFields.length?e.measure:e.categoryFields.join("/")).each(function(){F.noFormats||d3.select(this).style("font-family","sans-serif").style("font-size",(d/35>10?d/35:10)+"px")}),e===s?e.titleShape.each(function(){d3.select(this).attr("y",m+this.getBBox().height/1.65)}):e===r&&e.titleShape.each(function(){d3.select(this).attr("x",f+this.getBBox().height/1.65)}))},this),this.series.forEach(function(e){e.plot.draw(this,e,t),this._registerEventHandlers(e)},this),this.legends.forEach(function(e){e._draw(t)},this),null!==this.storyboard&&void 0!==this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay&&this.storyboard.startAnimation()),this},this.getColor=function(t){return(null===this._assignedColors[t]||void 0===this._assignedColors[t])&&(this._assignedColors[t]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[t]},this.setBounds=function(t,e,i,s){return this.x=t,this.y=e,this.width=i,this.height=s,this._xPixels=function(){return dimple._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return dimple._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return dimple._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return dimple._parseYPosition(this.height,this.svg.node())},this.draw(0,!0),this},this.setMargins=function(t,e,i,s){return this.x=t,this.y=e,this.width=0,this.height=0,this._xPixels=function(){return dimple._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return dimple._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return dimple._parentWidth(this.svg.node())-this._xPixels()-dimple._parseXPosition(i,this.svg.node())},this._heightPixels=function(){return dimple._parentHeight(this.svg.node())-this._yPixels()-dimple._parseYPosition(s,this.svg.node())},this.draw(0,!0),this},this.setStoryboard=function(t,e){return this.storyboard=new dimple.storyboard(this,t),null!==e&&void 0!==e&&(this.storyboard.onTick=e),this.storyboard}},dimple.color=function(t,e,i){this.fill=t,this.stroke=null===e||void 0===e?d3.rgb(t).darker(.5).toString():e,this.opacity=null===i||void 0===i?.8:i},dimple.eventArgs=function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null},dimple.legend=function(t,e,i,s,r,a,l){this.chart=t,this.series=l,this.x=e,this.y=i,this.width=s,this.height=r,this.horizontalAlign=a,this.shapes=null,this._draw=function(t){var e,i=this._getEntries(),s=0,r=0,a=0,l=0,n=this;null!==this.shapes&&void 0!==this.shapes&&this.shapes.transition().duration(.2*t).attr("opacity",0).remove(),e=this.chart._group.selectAll(".dontSelectAny").data(i).enter().append("g").attr("class","legend").attr("opacity",0),e.append("text").attr("id",function(t){return"legend_"+t.key}).attr("class","legendText").text(function(t){return t.key}).call(function(){n.chart.noFormats||this.style("font-family","sans-serif").style("font-size",(n.chart._heightPixels()/35>10?n.chart._heightPixels()/35:10)+"px").style("shape-rendering","crispEdges")}).each(function(){var t=this.getBBox();t.width>s&&(s=t.width),t.height>r&&(r=t.height)}),e.append("rect").attr("class","legendKey").attr("height",9).attr("width",15),r=(9>r?9:r)+2,s+=35,e.each(function(t){a+s>n._widthPixels()&&(a=0,l+=r),l>n._heightPixels()?d3.select(this).remove():(d3.select(this).select("text").attr("x","left"===n.horizontalAlign?n._xPixels()+15+5+a:n._xPixels()+(n._widthPixels()-a-s)+15+5).attr("y",function(){return n._yPixels()+l+this.getBBox().height/1.65}).attr("width",n._widthPixels()).attr("height",n._heightPixels()),d3.select(this).select("rect").attr("class","legend legendKey").attr("x","left"===n.horizontalAlign?n._xPixels()+a:n._xPixels()+(n._widthPixels()-a-s)).attr("y",n._yPixels()+l).attr("height",9).attr("width",15).style("fill",function(){return dimple._helpers.fill(t,n.chart,t.series)}).style("stroke",function(){return dimple._helpers.stroke(t,n.chart,t.series)}).style("opacity",function(){return dimple._helpers.opacity(t,n.chart,t.series)}).style("shape-rendering","crispEdges"),a+=s)}),e.transition().delay(.2*t).duration(.8*t).attr("opacity",1),this.shapes=e},this._getEntries=function(){var t=[];return null!==this.series&&void 0!==this.series&&this.series.forEach(function(e){e._positionData.forEach(function(i){var s,r=-1;for(s=0;s<t.length;s+=1)if(t[s].key===i.aggField.slice(-1)[0]){r=s;break}-1===r&&(t.push({key:i.aggField.slice(-1)[0],fill:i.fill,stroke:i.stroke,series:e,aggField:i.aggField}),r=t.length-1)})},this),t},this._heightPixels=function(){return dimple._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return dimple._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return dimple._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return dimple._parseYPosition(this.y,this.chart.svg.node())}},dimple.series=function(t,e,i,s,r,a,l,n,o){this.chart=t,this.x=i,this.y=s,this.z=r,this.c=a,this.plot=l,this.categoryFields=e,this.aggregate=n,this.stacked=o,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(t){var e,i,s,r={min:0,max:0},a=null,l=null,n=[],o=0,h=this._positionData;return"x"===t?(a=this.x,l=this.y):"y"===t?(a=this.y,l=this.x):"z"===t?a=this.z:"c"===t&&(a=this.c),a.showPercent?h.forEach(function(t){t[a.position+"Bound"]<r.min&&(r.min=t[a.position+"Bound"]),t[a.position+"Bound"]>r.max&&(r.max=t[a.position+"Bound"])},this):null===l||null===l.categoryFields||0===l.categoryFields.length?h.forEach(function(t){!this.stacked||"x"!==a.position&&"y"!==a.position?(t[a.position+"Value"]<r.min&&(r.min=t[a.position+"Value"]),t[a.position+"Value"]>r.max&&(r.max=t[a.position+"Value"])):t[a.position+"Value"]<0?r.min=r.min+t[a.position+"Value"]:r.max=r.max+t[a.position+"Value"]},this):(e=a.position+"Value",i=l.position+"Field",s=[],h.forEach(function(t){var r=t[i].join("/"),a=s.indexOf(r);-1===a&&(s.push(r),a=s.length-1),void 0===n[a]&&(n[a]={min:0,max:0},a>=o&&(o=a+1)),this.stacked?t[e]<0?n[a].min=n[a].min+t[e]:n[a].max=n[a].max+t[e]:(t[e]<n[a].min&&(n[a].min=t[e]),t[e]>n[a].max&&(n[a].max=t[e]))},this),n.forEach(function(t){void 0!==t&&(t.min<r.min&&(r.min=t.min),t.max>r.max&&(r.max=t.max))},this)),r},this._dropLineOrigin=function(){var t=0,e=0,i={x:null,y:null},s={x:null,y:null};return this.chart.axes.forEach(function(t){"x"===t.position&&null===s.x?s.x=t._hasTimeField()?this.chart._xPixels():t._origin:"y"===t.position&&null===s.y&&(s.y=t._hasTimeField()?this.chart._yPixels()+this.chart._heightPixels():t._origin)},this),this.chart.axes.forEach(function(r){"x"!==r.position||this.x.hidden?"y"!==r.position||this.y.hidden||(r===this.y&&(0===e?i.x=s.x:1===e&&(i.x=this.chart._xPixels()+this.chart._widthPixels())),e+=1):(r===this.x&&(0===t?i.y=s.y:1===t&&(i.y=this.chart._yPixels())),t+=1)},this),i},this.addEventHandler=function(t,e){this._eventHandlers.push({event:t,handler:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})}},dimple.storyboard=function(t,e){null!==e&&void 0!==e&&(e=[].concat(e)),this.chart=t,this.categoryFields=e,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(t){if(null===this.storyLabel||void 0===this.storyLabel){var e=this.chart,i=0;this.chart.axes.forEach(function(t){"x"===t.position&&(i+=1)},this),this.storyLabel=this.chart._group.append("text").attr("x",this.chart._xPixels()+.01*this.chart._widthPixels()).attr("y",this.chart._yPixels()+(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)*(i>1?1.25:-1)).call(function(){e.noFormats||this.style("font-family","sans-serif").style("font-size",(e._heightPixels()/35>10?e._heightPixels()/35:10)+"px")})}this.storyLabel.transition().duration(.2*t).attr("opacity",0),this.storyLabel.transition().delay(.2*t).text(this.categoryFields.join("\\")+": "+this.getFrameValue()).transition().duration(.8*t).attr("opacity",1)},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart.data.forEach(function(t){var e="";null!==this.categoryFields&&(this.categoryFields.forEach(function(i,s){s>0&&(e+="/"),e+=t[i]},this),-1===this._categories.indexOf(e)&&(this._categories.push(e),this._categories.length))},this),this._cachedCategoryFields=this._categoryFields),this._categories},this._goToFrameIndex=function(t){this._frame=t%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getFrameValue=function(){var t=null;return this._frame>=0&&this._getCategories().length>this._frame&&(t=this._getCategories()[this._frame]),t},this.goToFrame=function(t){if(this._getCategories().length>0){var e=this._getCategories().indexOf(t);this._goToFrameIndex(e)}},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval(function(t){return function(){t._goToFrameIndex(t._frame+1),null!==t.onTick&&t.onTick(t.getFrameValue()),t._drawText(t.frameDuration/2)}}(this),this.frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}},dimple.aggregateMethod.avg=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),t.count=null===t.count||void 0===t.count?1:parseFloat(t.count),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),e.count=null===e.count||void 0===e.count?1:parseFloat(e.count),(t.value*t.count+e.value*e.count)/(t.count+e.count)},dimple.aggregateMethod.count=function(t,e){return t.count=null===t.count||void 0===t.count?0:parseFloat(t.count),e.count=null===e.count||void 0===e.count?0:parseFloat(e.count),t.count+e.count},dimple.aggregateMethod.max=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value>e.value?t.value:e.value},dimple.aggregateMethod.min=function(t,e){return null===t.value?parseFloat(e.value):parseFloat(t.value)<parseFloat(e.value)?parseFloat(t.value):parseFloat(e.value)},dimple.aggregateMethod.sum=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value+e.value},dimple.plot.area={stacked:!0,supportedAxes:["x","y","c"],draw:function(t,e,i){var s,r,a=this,l=e._positionData,n=[],o=1,h=!1,d={};null!==t._tooltipGroup&&void 0!==t._tooltipGroup&&t._tooltipGroup.remove(),
(e.x._hasCategories()||e.y._hasCategories())&&(o=0),l.forEach(function(t){var e,i=[],s=!1;for(e=o;e<t.aggField.length;e+=1)i.push(t.aggField[e]);n.forEach(function(t){s=s||t===i.join("/")},this),s||n.push(i.join("/"))},this),null!==e.c&&void 0!==e.c&&(e.x._hasCategories()&&e.y._hasMeasure()||e.y._hasCategories()&&e.x._hasMeasure())&&(h=!0,n.forEach(function(s){dimple._addGradient(s,"fill-area-gradient-"+s.join("_").replace(" ",""),e.x._hasCategories()?e.x:e.y,l,t,i,"fill"),dimple._addGradient(s,"stroke-area-gradient-"+s.join("_").replace(" ",""),e.x._hasCategories()?e.x:e.y,l,t,i,"stroke")},this)),s=d3.svg.line().x(function(i){return dimple._helpers.cx(i,t,e)}).y(function(i){return dimple._helpers.cy(i,t,e)}),(null===e.shapes||void 0===e.shapes)&&(e.shapes=t._group.selectAll(".area").data(n).enter().append("svg:path").attr("opacity",function(e){return t.getColor(e).opacity})),e.shapes.data(n).transition().duration(i).attr("class",function(t){return"series area "+t.replace(" ","")}).attr("d",function(i){var r,a,n,o,h,u,c,p,g=[],x=0;for(r=dimple.filterData(l,"aggField",i),r.sort(function(i,s){var r=0;return e.x._hasCategories()?r=dimple._helpers.cx(i,t,e)<dimple._helpers.cx(s,t,e)?-1:1:e.y._hasCategories()&&(r=dimple._helpers.cy(i,t,e)<dimple._helpers.cy(s,t,e)?-1:1),r}),o=r.length-1;o>=0;o-=1)if(a=r[o],n={cx:0,cy:0,height:0,width:0,xOffset:0,yOffset:0},e.x._hasCategories()){if(n.cx=a.cx,n.width=a.width,n.xOffset=a.xOffset,void 0===d[a.xField])d[a.xField]=[];else{for(x=0,h=0;h<=d[a.xField].length;h+=1)c=d[a.xField][h],(a.cy>=0&&c>=0||a.cy<=0&&0>=c)&&Math.abs(c)<=Math.abs(a.cy)&&Math.abs(c)>Math.abs(x)&&(x=c);n.cy=x}g.push(n),d[a.xField].push(a.cy)}else if(e.y._hasCategories()){if(n.cy=a.cy,n.height=a.height,n.yOffset=a.yOffset,void 0===d[a.yField])d[a.yField]=[];else{for(x=0,u=0;u<=d[a.yField].length;u+=1)p=d[a.yField][u],(a.cx>=0&&p>=0||a.cx<=0&&0>=p)&&Math.abs(p)<=Math.abs(a.cx)&&Math.abs(p)>Math.abs(x)&&(x=p);n.cx=x}g.push(n),d[a.yField].push(a.cx)}return s(r.concat(g).concat(r[0]))}).call(function(){t.noFormats||this.attr("fill",function(e){return h?"url(#fill-area-gradient-"+e.join("_").replace(" ","")+")":t.getColor(e).fill}).attr("stroke",function(e){return h?"url(#stroke-area-gradient-"+e.join("_").replace(" ","")+")":t.getColor(e).stroke}).attr("stroke-width",e.lineWeight)}),r=t._group.selectAll(".markers").data(l).enter(),e.lineMarkers&&r.append("circle").transition().duration(i).attr("cx",function(i){return dimple._helpers.cx(i,t,e)}).attr("cy",function(i){return dimple._helpers.cy(i,t,e)}).attr("r",2+e.lineWeight).attr("fill","white").attr("stroke","none"),r.append("circle").on("mouseover",function(i){a.enterEventHandler(i,this,t,e)}).on("mouseleave",function(i){a.leaveEventHandler(i,this,t,e)}).transition().duration(i).attr("cx",function(i){return dimple._helpers.cx(i,t,e)}).attr("cy",function(i){return dimple._helpers.cy(i,t,e)}).attr("r",2+e.lineWeight).attr("opacity",function(i){return e.lineMarkers?t.getColor(i).opacity:0}).call(function(){t.noFormats||this.attr("fill","white").style("stroke-width",e.lineWeight).attr("stroke",function(i){return dimple._helpers.stroke(i,t,e)})})},enterEventHandler:function(t,e,i,s){var r,a,l,n=d3.select(e),o=parseFloat(n.attr("cx")),h=parseFloat(n.attr("cy")),d=parseFloat(n.attr("r")),u=dimple._helpers.opacity(t,i,s),c=dimple._helpers.fill(t,i,s),p=s._dropLineOrigin(),g=d3.rgb(d3.rgb(c).r+.6*(255-d3.rgb(c).r),d3.rgb(c).g+.6*(255-d3.rgb(c).g),d3.rgb(c).b+.6*(255-d3.rgb(c).b)),x=d3.rgb(d3.rgb(c).r+.8*(255-d3.rgb(c).r),d3.rgb(c).g+.8*(255-d3.rgb(c).g),d3.rgb(c).b+.8*(255-d3.rgb(c).b)),y=0,_=0,f=0,m=[];null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),i._tooltipGroup=i.svg.append("g"),n.style("opacity",1),i._tooltipGroup.append("circle").attr("cx",o).attr("cy",h).attr("r",d).attr("opacity",0).style("fill","none").style("stroke",c).style("stroke-width",1).transition().duration(375).ease("linear").attr("opacity",1).attr("r",d+4).style("stroke-width",2),null!==p.y&&i._tooltipGroup.append("line").attr("x1",o).attr("y1",h<p.y?h+d+4:h-d-4).attr("x2",o).attr("y2",h<p.y?h+d+4:h-d-4).style("fill","none").style("stroke",c).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",u).transition().delay(375).duration(375).ease("linear").attr("y2",h<p.y?p.y-1:p.y+1),null!==p.x&&i._tooltipGroup.append("line").attr("x1",o<p.x?o+d+4:o-d-4).attr("y1",h).attr("x2",o<p.x?o+d+4:o-d-4).attr("y2",h).style("fill","none").style("stroke",c).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",u).transition().delay(375).duration(375).ease("linear").attr("x2",o<p.x?p.x-1:p.x+1),r=i._tooltipGroup.append("g"),a=r.append("rect"),null!==s.categoryFields&&void 0!==s.categoryFields&&s.categoryFields.length>0&&s.categoryFields.forEach(function(e,i){m.push(e+(t.aggField[i]!==e?": "+t.aggField[i]:""))},this),s.x._hasTimeField()?m.push(s.x.timeField+": "+s.x._getFormat()(t.xField[0])):s.x._hasCategories()?s.x.categoryFields.forEach(function(e,i){m.push(e+(t.xField[i]!==e?": "+t.xField[i]:""))},this):m.push(s.x.measure+": "+s.x._getFormat()(t.width)),s.y._hasTimeField()?m.push(s.y.timeField+": "+s.y._getFormat()(t.yField[0])):s.y._hasCategories()?s.y.categoryFields.forEach(function(e,i){m.push(e+(t.yField[i]!==e?": "+t.yField[i]:""))},this):m.push(s.y.measure+": "+s.y._getFormat()(t.height)),null!==s.z&&void 0!==s.z&&m.push(s.z.measure+": "+s.z._getFormat()(t.zValue)),null!==s.c&&void 0!==s.c&&m.push(s.c.measure+": "+s.c._getFormat()(t.cValue)),m=m.filter(function(t,e){return m.indexOf(t)===e}),r.selectAll(".textHoverShapes").data(m).enter().append("text").text(function(t){return t}).style("font-family","sans-serif").style("font-size","10px"),r.each(function(){_=this.getBBox().width>_?this.getBBox().width:_,f=this.getBBox().width>f?this.getBBox().height:f}),r.selectAll("text").attr("x",0).attr("y",function(){return(y+=this.getBBox().height)-this.getBBox().height/2}),a.attr("x",-5).attr("y",-5).attr("height",Math.floor(y+5)-.5).attr("width",_+10).attr("rx",5).attr("ry",5).style("fill",x).style("stroke",g).style("stroke-width",2).style("opacity",.95),l=o+d+5+10+_>parseFloat(i.svg.attr("width")),r.attr("transform","translate("+(l?o-(d+5+10+_):o+d+5+10)+" , "+(h-(y-(f-5))/2)+")")},leaveEventHandler:function(t,e,i,s){d3.select(e).style("opacity",s.lineMarkers?dimple._helpers.opacity(t,i,s):0),null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove()}},dimple.plot.bar={stacked:!0,supportedAxes:["x","y","c"],draw:function(t,e,i){var s=this,r=e._positionData,a=null,l="series"+t.series.indexOf(e);null!==t._tooltipGroup&&void 0!==t._tooltipGroup&&t._tooltipGroup.remove(),a=null===e.shapes||void 0===e.shapes?t._group.selectAll("."+l).data(r):e.shapes.data(r,function(t){return t.key}),a.enter().append("rect").attr("id",function(t){return t.key}).attr("class",function(t){return l+" bar "+t.aggField.join(" ")+" "+t.xField.join(" ")+" "+t.yField.join(" ")}).attr("x",function(i){return dimple._helpers.x(i,t,e)}).attr("y",function(i){return dimple._helpers.y(i,t,e)+dimple._helpers.height(i,t,e)}).attr("width",function(i){return null!==i.xField&&i.xField.length>0?dimple._helpers.width(i,t,e):0}).attr("height",function(i){return null!==i.yField&&i.yField.length>0?dimple._helpers.height(i,t,e):0}).attr("opacity",function(i){return dimple._helpers.opacity(i,t,e)}).on("mouseover",function(i){s.enterEventHandler(i,this,t,e)}).on("mouseleave",function(){s.leaveEventHandler(t)}).call(function(){t.noFormats||this.attr("fill",function(i){return dimple._helpers.fill(i,t,e)}).attr("stroke",function(i){return dimple._helpers.stroke(i,t,e)})}),a.transition().duration(i).attr("x",function(i){return dimple._helpers.x(i,t,e)}).attr("y",function(i){return dimple._helpers.y(i,t,e)}).attr("width",function(i){return dimple._helpers.width(i,t,e)}).attr("height",function(i){return dimple._helpers.height(i,t,e)}).call(function(){t.noFormats||this.attr("fill",function(i){return dimple._helpers.fill(i,t,e)}).attr("stroke",function(i){return dimple._helpers.stroke(i,t,e)})}),a.exit().transition().duration(i).attr("x",function(i){return dimple._helpers.x(i,t,e)}).attr("y",function(i){return dimple._helpers.y(i,t,e)}).attr("width",function(i){return dimple._helpers.width(i,t,e)}).attr("height",function(i){return dimple._helpers.height(i,t,e)}).each("end",function(){d3.select(this).remove()}),e.shapes=a},enterEventHandler:function(t,e,i,s){var r,a,l=d3.select(e),n=parseFloat(l.attr("x")),o=parseFloat(l.attr("y")),h=parseFloat(l.attr("width")),d=parseFloat(l.attr("height")),u=l.attr("opacity"),c=l.attr("fill"),p=s._dropLineOrigin(),g=d3.rgb(d3.rgb(c).r+.6*(255-d3.rgb(c).r),d3.rgb(c).g+.6*(255-d3.rgb(c).g),d3.rgb(c).b+.6*(255-d3.rgb(c).b)),x=d3.rgb(d3.rgb(c).r+.8*(255-d3.rgb(c).r),d3.rgb(c).g+.8*(255-d3.rgb(c).g),d3.rgb(c).b+.8*(255-d3.rgb(c).b)),y=[],_=0,f=0,m=0;null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),i._tooltipGroup=i.svg.append("g"),s.x._hasCategories()||null===p.y||i._tooltipGroup.append("line").attr("x1",n<s.x._origin?n+1:n+h-1).attr("y1",o<p.y?o+d:o).attr("x2",n<s.x._origin?n+1:n+h-1).attr("y2",o<p.y?o+d:o).style("fill","none").style("stroke",c).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",u).transition().delay(375).duration(375).ease("linear").attr("y2",o<p.y?p.y-1:p.y+1),s.y._hasCategories()||null===p.x||i._tooltipGroup.append("line").attr("x1",n<p.x?n+h:n).attr("y1",o<s.y._origin?o+1:o+d-1).attr("x2",n<p.x?n+h:n).attr("y2",o<s.y._origin?o+1:o+d-1).style("fill","none").style("stroke",c).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",u).transition().delay(375).duration(375).ease("linear").attr("x2",n<p.x?p.x-1:p.x+1),r=i._tooltipGroup.append("g"),a=r.append("rect"),null!==s.categoryFields&&void 0!==s.categoryFields&&s.categoryFields.length>0&&s.categoryFields.forEach(function(e,i){y.push(e+(t.aggField[i]!==e?": "+t.aggField[i]:""))},this),s.x._hasTimeField()?y.push(s.x.timeField+": "+s.x._getFormat()(t.xField[0])):s.x._hasCategories()?s.x.categoryFields.forEach(function(e,i){y.push(e+(t.xField[i]!==e?": "+t.xField[i]:""))},this):y.push(s.x.measure+": "+s.x._getFormat()(t.width)),s.y._hasTimeField()?y.push(s.y.timeField+": "+s.y._getFormat()(t.yField[0])):s.y._hasCategories()?s.y.categoryFields.forEach(function(e,i){y.push(e+(t.yField[i]!==e?": "+t.yField[i]:""))},this):y.push(s.y.measure+": "+s.y._getFormat()(t.height)),null!==s.c&&void 0!==s.c&&y.push(s.c.measure+": "+s.c._getFormat()(s.c.showPercent?t.cPct:t.cValue)),y=y.filter(function(t,e){return y.indexOf(t)===e}),r.selectAll(".textHoverShapes").data(y).enter().append("text").text(function(t){return t}).style("font-family","sans-serif").style("font-size","10px"),r.each(function(){f=this.getBBox().width>f?this.getBBox().width:f,m=this.getBBox().width>m?this.getBBox().height:m}),r.selectAll("text").attr("x",0).attr("y",function(){return(_+=this.getBBox().height)-this.getBBox().height/2}),a.attr("x",-5).attr("y",-5).attr("height",Math.floor(_+5)-.5).attr("width",f+10).attr("rx",5).attr("ry",5).style("fill",x).style("stroke",g).style("stroke-width",2).style("opacity",.95),n+h+5+10+f<parseFloat(i.svg.attr("width"))?r.attr("transform","translate("+(n+h+5+10)+" , "+(o+d/2-(_-(m-5))/2)+")"):n-(15+f)>0?r.attr("transform","translate("+(n-(15+f))+" , "+(o+d/2-(_-(m-5))/2)+")"):o+d+_+10+5<parseFloat(i.svg.attr("height"))?r.attr("transform","translate("+(n+h/2-(10+f)/2)+" , "+(o+d+10)+")"):r.attr("transform","translate("+(n+h/2-(10+f)/2)+" , "+(o-_-(m-5))+")")},leaveEventHandler:function(t){null!==t._tooltipGroup&&void 0!==t._tooltipGroup&&t._tooltipGroup.remove()}},dimple.plot.bubble={stacked:!1,supportedAxes:["x","y","z","c"],draw:function(t,e,i){var s=this,r=e._positionData,a=null,l="series"+t.series.indexOf(e);null!==t._tooltipGroup&&void 0!==t._tooltipGroup&&t._tooltipGroup.remove(),a=null===e.shapes||void 0===e.shapes?t._group.selectAll("."+l).data(r):e.shapes.data(r,function(t){return t.key}),a.enter().append("circle").attr("id",function(t){return t.key}).attr("class",function(t){return l+" bubble "+t.aggField.join(" ")+" "+t.xField.join(" ")+" "+t.yField.join(" ")+" "+t.zField.join(" ")}).attr("cx",function(i){return e.x._hasCategories()?dimple._helpers.cx(i,t,e):e.x._origin}).attr("cy",function(i){return e.y._hasCategories()?dimple._helpers.cy(i,t,e):e.y._origin}).attr("r",0).attr("opacity",function(i){return dimple._helpers.opacity(i,t,e)}).on("mouseover",function(i){s.enterEventHandler(i,this,t,e)}).on("mouseleave",function(){s.leaveEventHandler(t)}).call(function(){t.noFormats||this.attr("fill",function(i){return dimple._helpers.fill(i,t,e)}).attr("stroke",function(i){return dimple._helpers.stroke(i,t,e)})}),a.transition().duration(i).attr("cx",function(i){return dimple._helpers.cx(i,t,e)}).attr("cy",function(i){return dimple._helpers.cy(i,t,e)}).attr("r",function(i){return dimple._helpers.r(i,t,e)}).call(function(){t.noFormats||this.attr("fill",function(i){return dimple._helpers.fill(i,t,e)}).attr("stroke",function(i){return dimple._helpers.stroke(i,t,e)})}),a.exit().transition().duration(i).attr("r",0).attr("cx",function(i){return e.x._hasCategories()?dimple._helpers.cx(i,t,e):e.x._origin}).attr("cy",function(i){return e.y._hasCategories()?dimple._helpers.cy(i,t,e):e.y._origin}).each("end",function(){d3.select(this).remove()}),e.shapes=a},enterEventHandler:function(t,e,i,s){var r,a,l,n=d3.select(e),o=parseFloat(n.attr("cx")),h=parseFloat(n.attr("cy")),d=parseFloat(n.attr("r")),u=n.attr("opacity"),c=n.attr("fill"),p=s._dropLineOrigin(),g=d3.rgb(d3.rgb(c).r+.6*(255-d3.rgb(c).r),d3.rgb(c).g+.6*(255-d3.rgb(c).g),d3.rgb(c).b+.6*(255-d3.rgb(c).b)),x=d3.rgb(d3.rgb(c).r+.8*(255-d3.rgb(c).r),d3.rgb(c).g+.8*(255-d3.rgb(c).g),d3.rgb(c).b+.8*(255-d3.rgb(c).b)),y=[],_=0,f=0,m=0;null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),i._tooltipGroup=i.svg.append("g"),i._tooltipGroup.append("circle").attr("cx",o).attr("cy",h).attr("r",d).attr("opacity",0).style("fill","none").style("stroke",c).style("stroke-width",1).transition().duration(375).ease("linear").attr("opacity",1).attr("r",d+4).style("stroke-width",2),null!==p.y&&i._tooltipGroup.append("line").attr("x1",o).attr("y1",h<p.y?h+d+4:h-d-4).attr("x2",o).attr("y2",h<p.y?h+d+4:h-d-4).style("fill","none").style("stroke",c).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",u).transition().delay(375).duration(375).ease("linear").attr("y2",h<p.y?p.y-1:p.y+1),null!==p.x&&i._tooltipGroup.append("line").attr("x1",o<p.x?o+d+4:o-d-4).attr("y1",h).attr("x2",o<p.x?o+d+4:o-d-4).attr("y2",h).style("fill","none").style("stroke",c).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",u).transition().delay(375).duration(375).ease("linear").attr("x2",o<p.x?p.x-1:p.x+1),r=i._tooltipGroup.append("g"),a=r.append("rect"),null!==s.categoryFields&&void 0!==s.categoryFields&&s.categoryFields.length>0&&s.categoryFields.forEach(function(e,i){y.push(e+(t.aggField[i]!==e?": "+t.aggField[i]:""))},this),s.x._hasTimeField()?y.push(s.x.timeField+": "+s.x._getFormat()(t.xField[0])):s.x._hasCategories()?s.x.categoryFields.forEach(function(e,i){y.push(e+(t.xField[i]!==e?": "+t.xField[i]:""))},this):y.push(s.x.measure+": "+s.x._getFormat()(t.cx)),s.y._hasTimeField()?y.push(s.y.timeField+": "+s.y._getFormat()(t.yField[0])):s.y._hasCategories()?s.y.categoryFields.forEach(function(e,i){y.push(e+(t.yField[i]!==e?": "+t.yField[i]:""))},this):y.push(s.y.measure+": "+s.y._getFormat()(t.cy)),null!==s.z&&void 0!==s.z&&y.push(s.z.measure+": "+s.z._getFormat()(t.zValue)),null!==s.c&&void 0!==s.c&&y.push(s.c.measure+": "+s.c._getFormat()(t.cValue)),y=y.filter(function(t,e){return y.indexOf(t)===e}),r.selectAll(".textHoverShapes").data(y).enter().append("text").text(function(t){return t}).style("font-family","sans-serif").style("font-size","10px"),r.each(function(){f=this.getBBox().width>f?this.getBBox().width:f,m=this.getBBox().width>m?this.getBBox().height:m}),r.selectAll("text").attr("x",0).attr("y",function(){return(_+=this.getBBox().height)-this.getBBox().height/2}),a.attr("x",-5).attr("y",-5).attr("height",Math.floor(_+5)-.5).attr("width",f+10).attr("rx",5).attr("ry",5).style("fill",x).style("stroke",g).style("stroke-width",2).style("opacity",.95),l=o+d+5+10+f>parseFloat(i.svg.attr("width")),r.attr("transform","translate("+(l?o-(d+5+10+f):o+d+5+10)+" , "+(h-(_-(m-5))/2)+")")},leaveEventHandler:function(t){null!==t._tooltipGroup&&void 0!==t._tooltipGroup&&t._tooltipGroup.remove()}},dimple.plot.line={stacked:!1,supportedAxes:["x","y","c"],draw:function(t,e,i){var s,r,a=this,l=e._positionData,n=[],o=[],h=1,d=!1;null!==t._tooltipGroup&&void 0!==t._tooltipGroup&&t._tooltipGroup.remove(),(e.x._hasCategories()||e.y._hasCategories())&&(h=0),l.forEach(function(t){var e,i=[],s=!1;for(e=h;e<t.aggField.length;e+=1)i.push(t.aggField[e]);o.forEach(function(t){s=s||t.join("/")===i.join("/")},this),s||o.push(i)},this),null!==e.c&&void 0!==e.c&&(e.x._hasCategories()&&e.y._hasMeasure()||e.y._hasCategories()&&e.x._hasMeasure())&&(d=!0,o.forEach(function(s){dimple._addGradient(s,"fill-line-gradient-"+s.join("_").replace(" ",""),e.x._hasCategories()?e.x:e.y,l,t,i,"fill")},this)),s=d3.svg.line().x(function(i){return dimple._helpers.cx(i,t,e)}).y(function(i){return dimple._helpers.cy(i,t,e)}),(null===e.shapes||void 0===e.shapes)&&(e.shapes=t._group.selectAll(".line").data(o).enter().append("svg:path").attr("opacity",function(e){return t.getColor(e).opacity})),e.shapes.data(o).transition().duration(i).attr("class",function(t){return"series line "+t.join("_").replace(" ","")}).attr("d",function(i){var r=[];return l.forEach(function(t){var e,s=!0;for(e=h;e<t.aggField.length;e+=1)s=s&&i[e-h]===t.aggField[e];s&&r.push(t)},this),r.sort(function(i,s){var r=0;return e.x._hasCategories()?r=dimple._helpers.cx(i,t,e)<dimple._helpers.cx(s,t,e)?-1:1:e.y._hasCategories()&&(r=dimple._helpers.cy(i,t,e)<dimple._helpers.cy(s,t,e)?-1:1),r}),1===r.length&&(n.push({cx:dimple._helpers.cx(r[0],t,e),cy:dimple._helpers.cy(r[0],t,e),opacity:t.getColor(i[i.length-1]).opacity,color:t.getColor(i[i.length-1]).stroke}),d3.select(this).remove()),s(r)}).call(function(){t.noFormats||this.attr("fill","none").attr("stroke",function(e){return d?"url(#fill-line-gradient-"+e.join("_").replace(" ","")+")":t.getColor(e[e.length-1]).stroke}).attr("stroke-width",e.lineWeight)}),r=t._group.selectAll(".markers").data(l).enter(),e.lineMarkers&&r.append("circle").transition().duration(i).attr("cx",function(i){return dimple._helpers.cx(i,t,e)}).attr("cy",function(i){return dimple._helpers.cy(i,t,e)}).attr("r",2+e.lineWeight).attr("fill","white").attr("stroke","none"),r.append("circle").on("mouseover",function(i){a.enterEventHandler(i,this,t,e)}).on("mouseleave",function(i){a.leaveEventHandler(i,this,t,e)}).transition().duration(i).attr("cx",function(i){return dimple._helpers.cx(i,t,e)}).attr("cy",function(i){return dimple._helpers.cy(i,t,e)}).attr("r",2+e.lineWeight).attr("opacity",function(i){return e.lineMarkers?t.getColor(i).opacity:0}).call(function(){t.noFormats||this.attr("fill","white").style("stroke-width",e.lineWeight).attr("stroke",function(i){return d?dimple._helpers.fill(i,t,e):t.getColor(i.aggField[i.aggField.length-1]).stroke})}),e.lineMarkers||t._group.selectAll(".fill").data(n).enter().append("circle").attr("cx",function(t){return t.cx}).attr("cy",function(t){return t.cy}).attr("r",e.lineWeight).attr("opacity",function(t){return t.opacity}).call(function(){t.noFormats||this.attr("fill",function(t){return t.color}).attr("stroke","none")})},enterEventHandler:function(t,e,i,s){var r,a,l,n=d3.select(e),o=parseFloat(n.attr("cx")),h=parseFloat(n.attr("cy")),d=parseFloat(n.attr("r")),u=dimple._helpers.opacity(t,i,s),c=n.attr("stroke"),p=s._dropLineOrigin(),g=d3.rgb(d3.rgb(c).r+.6*(255-d3.rgb(c).r),d3.rgb(c).g+.6*(255-d3.rgb(c).g),d3.rgb(c).b+.6*(255-d3.rgb(c).b)),x=d3.rgb(d3.rgb(c).r+.8*(255-d3.rgb(c).r),d3.rgb(c).g+.8*(255-d3.rgb(c).g),d3.rgb(c).b+.8*(255-d3.rgb(c).b)),y=0,_=0,f=0,m=[];null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),i._tooltipGroup=i.svg.append("g"),n.style("opacity",1),i._tooltipGroup.append("circle").attr("cx",o).attr("cy",h).attr("r",d).attr("opacity",0).style("fill","none").style("stroke",c).style("stroke-width",1).transition().duration(375).ease("linear").attr("opacity",1).attr("r",d+s.lineWeight+2).style("stroke-width",2),null!==p.y&&i._tooltipGroup.append("line").attr("x1",o).attr("y1",h<p.y?h+d+s.lineWeight+2:h-d-s.lineWeight-2).attr("x2",o).attr("y2",h<p.y?h+d+s.lineWeight+2:h-d-s.lineWeight-2).style("fill","none").style("stroke",c).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",u).transition().delay(375).duration(375).ease("linear").attr("y2",h<p.y?p.y-1:p.y+1),null!==p.x&&i._tooltipGroup.append("line").attr("x1",o<p.x?o+d+s.lineWeight+2:o-d-s.lineWeight-2).attr("y1",h).attr("x2",o<p.x?o+d+s.lineWeight+2:o-d-s.lineWeight-2).attr("y2",h).style("fill","none").style("stroke",c).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",u).transition().delay(375).duration(375).ease("linear").attr("x2",o<p.x?p.x-1:p.x+1),r=i._tooltipGroup.append("g"),a=r.append("rect"),null!==s.categoryFields&&void 0!==s.categoryFields&&s.categoryFields.length>0&&s.categoryFields.forEach(function(e,i){m.push(e+(t.aggField[i]!==e?": "+t.aggField[i]:""))},this),s.x._hasTimeField()?m.push(s.x.timeField+": "+s.x._getFormat()(t.xField[0])):s.x._hasCategories()?s.x.categoryFields.forEach(function(e,i){m.push(e+(t.xField[i]!==e?": "+t.xField[i]:""))},this):s.x.useLog?m.push(s.x.measure+": "+t.cx):m.push(s.x.measure+": "+s.x._getFormat()(t.cx)),s.y._hasTimeField()?m.push(s.y.timeField+": "+s.y._getFormat()(t.yField[0])):s.y._hasCategories()?s.y.categoryFields.forEach(function(e,i){m.push(e+(t.yField[i]!==e?": "+t.yField[i]:""))},this):s.y.useLog?m.push(s.y.measure+": "+t.cy):m.push(s.y.measure+": "+s.y._getFormat()(t.cy)),null!==s.z&&void 0!==s.z&&m.push(s.z.measure+": "+s.z._getFormat()(t.zValue)),null!==s.c&&void 0!==s.c&&m.push(s.c.measure+": "+s.c._getFormat()(t.cValue)),m=m.filter(function(t,e){return m.indexOf(t)===e}),r.selectAll(".textHoverShapes").data(m).enter().append("text").text(function(t){return t}).style("font-family","sans-serif").style("font-size","10px"),r.each(function(){_=this.getBBox().width>_?this.getBBox().width:_,f=this.getBBox().width>f?this.getBBox().height:f}),r.selectAll("text").attr("x",0).attr("y",function(){return(y+=this.getBBox().height)-this.getBBox().height/2}),a.attr("x",-5).attr("y",-5).attr("height",Math.floor(y+5)-.5).attr("width",_+10).attr("rx",5).attr("ry",5).style("fill",x).style("stroke",g).style("stroke-width",2).style("opacity",.95),l=o+d+5+10+_>parseFloat(i.svg.attr("width")),r.attr("transform","translate("+(l?o-(d+5+10+_):o+d+5+10)+" , "+(h-(y-(f-5))/2)+")")},leaveEventHandler:function(t,e,i,s){d3.select(e).style("opacity",s.lineMarkers?dimple._helpers.opacity(t,i,s):0),null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove()}},dimple._addGradient=function(t,e,i,s,r,a,l){var n=r._group.select("#"+e),o=[],h=i.position+"Field",d=!0,u=[];s.forEach(function(t){-1===o.indexOf(t[h])&&o.push(t[h])},this),o=o.sort(function(t,e){return i._scale(t)-i._scale(e)}),null===n.node()&&(d=!1,n=r._group.append("linearGradient").attr("id",e).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===i.position?i._scale(o[0])+r._widthPixels()/o.length/2:0).attr("y1","y"===i.position?i._scale(o[0])-r._heightPixels()/o.length/2:0).attr("x2","x"===i.position?i._scale(o[o.length-1])+r._widthPixels()/o.length/2:0).attr("y2","y"===i.position?i._scale(o[o.length-1])-r._heightPixels()/o.length/2:0)),o.forEach(function(e,i){var r={},a=0;for(a=0;a<s.length;a+=1)if(s[a].aggField.join("_")===t.join("_")&&s[a][h].join("_")===e.join("_")){r=s[a];break}u.push({offset:Math.round(i/(o.length-1)*100)+"%",color:r[l]})},this),d?n.selectAll("stop").data(u).transition().duration(a).attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}):n.selectAll("stop").data(u).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color})},dimple._getOrderedList=function(t,e,i){var s=[],r=[],a=[],l=[e],n=[];return null!==i&&void 0!==i&&(n=n.concat(i)),n=n.concat({ordering:e,desc:!1}),n.forEach(function(e){var i;if("function"==typeof e.ordering)for(i in t[0])t[0].hasOwnProperty(i)&&-1===l.indexOf(i)&&l.push(i);else e.ordering instanceof Array||l.push(e.ordering)},this),s=dimple._rollUp(t,e,l),n.length>=1&&(n.forEach(function(t){var i=null!==t.desc&&void 0!==t.desc&&t.desc,s=t.ordering,a=[],l="string"==typeof s?s:null,n=function(t){var e,i=0;for(e=0;e<t.length;e+=1){if(isNaN(t[e])){i=0;break}i+=parseFloat(t[e])}return i},o=function(t,e){var i=0,s=n(t),r=n(e);return isNaN(s)||0===s||isNaN(r)||0===r?isNaN(Date.parse(t[0]))||isNaN(Date.parse(e[0]))?t[0]<e[0]?i=-1:t[0]>e[0]&&(i=1):i=Date.parse(t[0])-Date.parse(e[0]):i=parseFloat(s)-parseFloat(r),i};"function"==typeof s?r.push(function(t,e){return(i?-1:1)*s(t,e)}):s instanceof Array?(s.forEach(function(t){a.push([].concat(t).join("|"))},this),r.push(function(t,s){var r,l,n="".concat(t[e]),o="".concat(s[e]);return r=a.indexOf(n),l=a.indexOf(o),r=0>r?i?-1:a.length:r,l=0>l?i?-1:a.length:l,(i?-1:1)*(r-l)})):r.push(function(t,e){var s=0;return void 0!==t[l]&&void 0!==e[l]&&(s=o([].concat(t[l]),[].concat(e[l]))),(i?-1:1)*s})}),s.sort(function(t,e){for(var i=0,s=0;i<r.length&&0===s;)s=r[i](t,e),i+=1;return s}),s.forEach(function(t){a.push(t[e])},this)),a},dimple._helpers={cx:function(t,e,i){return null!==i.x.measure&&void 0!==i.x.measure?i.x._scale(t.cx):i.x._hasCategories()&&i.x.categoryFields.length>=2?i.x._scale(t.cx)+dimple._helpers.xGap(e,i)+(t.xOffset+.5)*(e._widthPixels()/i.x._max-2*dimple._helpers.xGap(e,i))*t.width:i.x._scale(t.cx)+e._widthPixels()/i.x._max/2},cy:function(t,e,i){return null!==i.y.measure&&void 0!==i.y.measure?i.y._scale(t.cy):null!==i.y.categoryFields&&void 0!==i.y.categoryFields&&i.y.categoryFields.length>=2?i.y._scale(t.cy)-e._heightPixels()/i.y._max+dimple._helpers.yGap(e,i)+(t.yOffset+.5)*(e._heightPixels()/i.y._max-2*dimple._helpers.yGap(e,i))*t.height:i.y._scale(t.cy)-e._heightPixels()/i.y._max/2},r:function(t,e,i){return null===i.z||void 0===i.z?5:i.z._hasMeasure()?i.z._scale(t.r):i.z._scale(e._heightPixels()/100)},xGap:function(t,e){var i=0;return(null===e.x.measure||void 0===e.x.measure)&&e.barGap>0&&(i=t._widthPixels()/e.x._max*(e.barGap>.99?.99:e.barGap)/2),i},xClusterGap:function(t,e,i){var s=0;return null!==i.x.categoryFields&&void 0!==i.x.categoryFields&&i.x.categoryFields.length>=2&&i.clusterBarGap>0&&!i.x._hasMeasure()&&(s=t.width*(e._widthPixels()/i.x._max-2*dimple._helpers.xGap(e,i))*(i.clusterBarGap>.99?.99:i.clusterBarGap)/2),s},yGap:function(t,e){var i=0;return(null===e.y.measure||void 0===e.y.measure)&&e.barGap>0&&(i=t._heightPixels()/e.y._max*(e.barGap>.99?.99:e.barGap)/2),i},yClusterGap:function(t,e,i){var s=0;return null!==i.y.categoryFields&&void 0!==i.y.categoryFields&&i.y.categoryFields.length>=2&&i.clusterBarGap>0&&!i.y._hasMeasure()&&(s=t.height*(e._heightPixels()/i.y._max-2*dimple._helpers.yGap(e,i))*(i.clusterBarGap>.99?.99:i.clusterBarGap)/2),s},x:function(t,e,i){return i.x._hasTimeField()?i.x._scale(t.x)-dimple._helpers.width(t,e,i)/2:null!==i.x.measure&&void 0!==i.x.measure?i.x._scale(t.x):i.x._scale(t.x)+dimple._helpers.xGap(e,i)+t.xOffset*(dimple._helpers.width(t,e,i)+2*dimple._helpers.xClusterGap(t,e,i))+dimple._helpers.xClusterGap(t,e,i)},y:function(t,e,i){return i.y._hasTimeField()?i.y._scale(t.y)-dimple._helpers.height(t,e,i)/2:null!==i.y.measure&&void 0!==i.y.measure?i.y._scale(t.y):i.y._scale(t.y)-e._heightPixels()/i.y._max+dimple._helpers.yGap(e,i)+t.yOffset*(dimple._helpers.height(t,e,i)+2*dimple._helpers.yClusterGap(t,e,i))+dimple._helpers.yClusterGap(t,e,i)},width:function(t,e,i){return null!==i.x.measure&&void 0!==i.x.measure?Math.abs(i.x._scale(t.x<0?t.x-t.width:t.x+t.width)-i.x._scale(t.x)):i.x._hasTimeField()?i.x.floatingBarWidth:t.width*(e._widthPixels()/i.x._max-2*dimple._helpers.xGap(e,i))-2*dimple._helpers.xClusterGap(t,e,i)},height:function(t,e,i){return i.y._hasTimeField()?i.y.floatingBarWidth:null!==i.y.measure&&void 0!==i.y.measure?Math.abs(i.y._scale(t.y)-i.y._scale(t.y<=0?t.y+t.height:t.y-t.height)):t.height*(e._heightPixels()/i.y._max-2*dimple._helpers.yGap(e,i))-2*dimple._helpers.yClusterGap(t,e,i)},opacity:function(t,e,i){return null!==i.c&&void 0!==i.c?t.opacity:e.getColor(t.aggField.slice(-1)[0]).opacity},fill:function(t,e,i){return null!==i.c&&void 0!==i.c?t.fill:e.getColor(t.aggField.slice(-1)[0]).fill},stroke:function(t,e,i){return null!==i.c&&void 0!==i.c?t.stroke:e.getColor(t.aggField.slice(-1)[0]).stroke}},dimple._parentHeight=function(t){var e=t.offsetHeight;return(0>=e||null===e||void 0===e)&&(e=t.clientHeight),(0>=e||null===e||void 0===e)&&(e=null===t.parentNode||void 0===t.parentNode?0:dimple._parseYPosition(d3.select(t).attr("height"),t.parentNode)),e},dimple._parentWidth=function(t){var e=t.offsetWidth;return(0>=e||null===e||void 0===e)&&(e=t.clientWidth),(0>=e||null===e||void 0===e)&&(e=null===t.parentNode||void 0===t.parentNode?0:dimple._parseXPosition(d3.select(t).attr("width"),t.parentNode)),e},dimple._parseXPosition=function(t,e){var i=t;return void 0===t||null===t?i=0:isNaN(t)?"%"===t.slice(-1)?i=dimple._parentWidth(e)*(parseFloat(t.slice(0,t.length-1))/100):"px"===t.slice(-2)&&(i=parseFloat(t.slice(0,t.length-2))):i=t,i},dimple._parseYPosition=function(t,e){var i=t;return void 0===t||null===t?i=0:isNaN(t)?"%"===t.slice(-1)?i=dimple._parentHeight(e)*(parseFloat(t.slice(0,t.length-1))/100):"px"===t.slice(-2)&&(i=parseFloat(t.slice(0,t.length-2))):i=t,i},dimple._rollUp=function(t,e,i){var s=[];return e=null!==e&&void 0!==e?[].concat(e):[],t.forEach(function(t){var r=-1,a={},l=!0;s.forEach(function(i,s){-1===r&&(l=!0,e.forEach(function(e){l=l&&t[e]===i[e]},this),l&&(r=s))},this),-1!==r?a=s[r]:(e.forEach(function(e){a[e]=t[e]},this),s.push(a),r=s.length-1),i.forEach(function(i){-1===e.indexOf(i)&&(void 0===a[i]&&(a[i]=[]),a[i]=a[i].concat(t[i]))},this),s[r]=a},this),s},dimple.filterData=function(t,e,i){var s=t;return null!==e&&null!==i&&(null!==i&&void 0!==i&&(i=[].concat(i)),s=[],t.forEach(function(t){null===t[e]?s.push(t):i.indexOf([].concat(t[e]).join("/"))>-1&&s.push(t)},this)),s},dimple.getUniqueValues=function(t,e){var i=[];return null!==e&&void 0!==e&&(e=[].concat(e),t.forEach(function(t){var s="";e.forEach(function(e,i){i>0&&(s+="/"),s+=t[e]},this),-1===i.indexOf(s)&&i.push(s)},this)),i},dimple.newSvg=function(t,e,i){var s=null;if((null===t||void 0===t)&&(t="body"),s=d3.select(t),s.empty())throw"The '"+t+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return s.append("svg").attr("width",e).attr("height",i)}}();
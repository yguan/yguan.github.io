var dimple={version:"1.0.0",plot:{},aggregateMethod:{}};!function(){dimple.axis=function(e,t,n,r,i){this.chart=e,this.position=t,this.categoryFields=null===i||void 0===i?n:[].concat(i),this.measure=r,this.timeField=i,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getFormat=function(){var e,t,n,r,i,s,o;return null!==this.tickFormat&&void 0!==this.tickFormat?e=this._hasTimeField()?d3.time.format(this.tickFormat):d3.format(this.tickFormat):this.showPercent?e=d3.format("%"):this.useLog&&null!==this.measure?e=function(e){var t=Math.floor(Math.abs(e),0).toString().length,n=Math.min(Math.floor((t-1)/3),4),r="kmBT".substring(n-1,n),i="0"===Math.round(10*(e/Math.pow(1e3,n))).toString().slice(-1)?0:1;return 0===e?0:d3.format(",."+i+"f")(e/Math.pow(1e3,n))+r}:null!==this.measure?(t=Math.floor(Math.abs(this._max),0).toString(),n=Math.floor(Math.abs(this._min),0).toString(),r=Math.max(n.length,t.length),r>3?(i=Math.min(Math.floor((r-1)/3),4),s="kmBT".substring(i-1,i),o=1>=r-3*i?1:0,e=function(e){return 0===e?0:d3.format(",."+o+"f")(e/Math.pow(1e3,i))+s}):(o=1>=r?1:0,e=d3.format(",."+o+"f"))):e=function(e){return e},e},this._getTimePeriod=function(){var e=this.timePeriod,t=30,n=this._max-this._min;return!this._hasTimeField||null!==this.timePeriod&&void 0!==this.timePeriod||(e=t>=n/1e3?d3.time.seconds:t>=n/6e4?d3.time.minutes:t>=n/36e5?d3.time.hours:t>=n/864e5?d3.time.days:t>=n/6048e5?d3.time.weeks:t>=n/26298e5?d3.time.months:d3.time.years),e},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(e){var t;return t=null===this.dateParseFormat||void 0===this.dateParseFormat?Date.parse(e):d3.time.format(this.dateParseFormat).parse(e)},this._update=function(e){var t,n,r,i,s=[],o=function(e,t,n){var r,i=e.categoryFields[0],s=i,o=!1,u=!0,a=[];for(r=0;r<e.chart.data.length;r+=1)if(isNaN(e._parseDate(e.chart.data[r][i]))){u=!1;break}return u||e.chart.series.forEach(function(r){r[t]===e&&r[n]._hasMeasure()&&(s=r[n].measure,o=!0)},this),a=e._orderRules.concat({ordering:s,desc:o}),dimple._getOrderedList(e.chart.data,i,a)};if(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&this._max>1?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,"x"===this.position){if(this._hasTimeField()?this._scale=d3.time.scale().rangeRound([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]):this.useLog?this._scale=d3.scale.log().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(!0).base(this.logBase).nice():null===this.measure||void 0===this.measure?(s=o(this,"x","y"),this._scale=d3.scale.ordinal().rangePoints([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(s.concat([""]))):this._scale=d3.scale.linear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).nice(),!this.hidden)switch(this.chart._axisIndex(this,"x")){case 0:this._draw=d3.svg.axis().orient("bottom").scale(this._scale);break;case 1:this._draw=d3.svg.axis().orient("top").scale(this._scale)}}else if("y"===this.position){if(this._hasTimeField()?this._scale=d3.time.scale().rangeRound([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]):this.useLog?this._scale=d3.scale.log().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(!0).base(this.logBase).nice():null===this.measure||void 0===this.measure?(s=o(this,"y","x"),this._scale=d3.scale.ordinal().rangePoints([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(s.concat([""]))):this._scale=d3.scale.linear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).nice(),!this.hidden)switch(this.chart._axisIndex(this,"y")){case 0:this._draw=d3.svg.axis().orient("left").scale(this._scale);break;case 1:this._draw=d3.svg.axis().orient("right").scale(this._scale)}}else this.position.length>0&&"z"===this.position[0]?this._scale=this.useLog?d3.scale.log().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(!0).base(this.logBase):d3.scale.linear().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([this._min,this._max]):this.position.length>0&&"c"===this.position[0]&&(this._scale=d3.scale.linear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]));return null!==e&&void 0!==e&&e!==!1||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(this._scale.ticks(10).length>0)||"x"!==this.position&&"y"!==this.position||(t=this._scale.ticks(10),n=t[1]-t[0],r=((this._max-this._min)%n).toFixed(0),0!==r&&(this._max=Math.ceil(this._max/n)*n,this._min=Math.floor(this._min/n)*n,this._update(!0))),i=this._scale.copy()(0),this._origin!==i&&(this._previousOrigin=null===this._origin?i:this._origin,this._origin=i),this},this.addGroupOrderRule=function(e,t){this._groupOrderRules.push({ordering:e,desc:t})},this.addOrderRule=function(e,t){this._orderRules.push({ordering:e,desc:t})}},dimple.chart=function(e,t){this.svg=e,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=t,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this._group=e.append("g"),this._tooltipGroup=null,this._assignedColors={},this._nextColor=0,this._axisIndex=function(e,t){var n=0,r=0,i=-1;for(n=0;n<this.axes.length;n+=1){if(this.axes[n]===e){i=r;break}(null===t||void 0===t||t[0]===this.axes[n].position[0])&&(r+=1)}return i},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach(function(e){var t,n,r=[],i=function(e,t){var n=[];return null!==e&&(e._hasTimeField()?n.push(e._parseDate(t[e.timeField])):e._hasCategories()&&e.categoryFields.forEach(function(e){n.push(t[e])},this)),n},s={x:!1,y:!1,z:!1,c:!1},o={x:[],y:[]},u={x:[],y:[],z:[]},a={min:null,max:null},f={x:[],y:[],z:[]},l=[],c={},h={x:0,y:0,z:0},p="",d=[],v="",m=[],g="",y=[],b="",w=[],E=[],S=this.data,x=[];null!==this.storyboard&&void 0!==this.storyboard&&this.storyboard.categoryFields.length>0&&(p=this.storyboard.categoryFields[0],d=dimple._getOrderedList(this.data,p,this.storyboard._orderRules)),e.x._hasCategories()&&e.x._hasMeasure()&&(g=e.x.categoryFields[0],y=dimple._getOrderedList(this.data,g,e.x._orderRules.concat([{ordering:e.x.measure,desc:!0}]))),e.y._hasCategories()&&e.y._hasMeasure()&&(b=e.y.categoryFields[0],w=dimple._getOrderedList(this.data,b,e.y._orderRules.concat([{ordering:e.y.measure,desc:!0}]))),null!==e.categoryFields&&void 0!==e.categoryFields&&e.categoryFields.length>0&&(E=[].concat(e._orderRules),v=e.categoryFields[0],null!==e.c&&void 0!==e.c&&e.c._hasMeasure()?E.push({ordering:e.c.measure,desc:!0}):null!==e.z&&void 0!==e.z&&e.z._hasMeasure()?E.push({ordering:e.z.measure,desc:!0}):e.x._hasMeasure()?E.push({ordering:e.x.measure,desc:!0}):e.y._hasMeasure()&&E.push({ordering:e.y.measure,desc:!0}),m=dimple._getOrderedList(this.data,v,E)),S.sort(function(e,t){var n=0;return""!==p&&(n=d.indexOf(e[p])-d.indexOf(t[p])),""!==g&&0===n&&(n=y.indexOf(e[g])-y.indexOf(t[g])),""!==b&&0===n&&(n=w.indexOf(e[b])-w.indexOf(t[b])),""!==v&&0===n&&(n=m.indexOf(e[v])-m.indexOf(t[v])),n}),S.forEach(function(t){var n,o,u,a,f=-1,l=i(e.x,t),c=i(e.y,t),h=i(e.z,t),p=[];for(null===e.categoryFields||void 0===e.categoryFields||0===e.categoryFields.length?p=["All"]:1===e.categoryFields.length&&void 0===t[e.categoryFields[0]]?p=[e.categoryFields[0]]:e.categoryFields.forEach(function(e){p.push(t[e])},this),n=p.join("/")+"_"+l.join("/")+"_"+c.join("/")+"_"+h.join("/"),o=0;o<r.length;o+=1)if(r[o].key===n){f=o;break}-1===f&&(u={key:n,aggField:p,xField:l,xValue:null,xCount:0,yField:c,yValue:null,yCount:0,zField:h,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],cValueList:[],fill:{},stroke:{}},r.push(u),f=r.length-1),a=function(n,i){var o,u,a=!0,l={value:0,count:1},c={value:0,count:1},h="";null!==i&&(o=i.getFrameValue(),i.categoryFields.forEach(function(e,n){n>0&&(h+="/"),h+=t[e],a=h===o},this)),null!==n&&void 0!==n&&a&&(u=r[f],n._hasMeasure()&&(void 0===t[n.measure]&&(t[n.measure]=0),-1===u[n.position+"ValueList"].indexOf(t[n.measure])&&u[n.position+"ValueList"].push(t[n.measure]),isNaN(parseFloat(t[n.measure]))&&(s[n.position]=!0),l.value=u[n.position+"Value"],l.count=u[n.position+"Count"],c.value=t[n.measure],u[n.position+"Value"]=e.aggregate(l,c),u[n.position+"Count"]+=1))},a(e.x,this.storyboard),a(e.y,this.storyboard),a(e.z,this.storyboard),a(e.c,this.storyboard)},this),null!==e.x&&void 0!==e.x&&e.x._hasCategories()&&e.x.categoryFields.length>1&&void 0!==o.x&&(x=[],e.y._hasMeasure()&&x.push({ordering:e.y.measure,desc:!0}),o.x=dimple._getOrderedList(this.data,e.x.categoryFields[1],e.x._groupOrderRules.concat(x))),null!==e.y&&void 0!==e.y&&e.y._hasCategories()&&e.y.categoryFields.length>1&&void 0!==o.y&&(x=[],e.x._hasMeasure()&&x.push({ordering:e.x.measure,desc:!0}),o.y=dimple._getOrderedList(this.data,e.y.categoryFields[1],e.y._groupOrderRules.concat(x)),o.y.reverse()),r.forEach(function(n){null!==e.x&&(s.x===!0&&(n.xValue=n.xValueList.length),t=(null===u.x[n.xField.join("/")]||void 0===u.x[n.xField.join("/")]?0:u.x[n.xField.join("/")])+(e.y._hasMeasure()?Math.abs(n.yValue):0),u.x[n.xField.join("/")]=t),null!==e.y&&(s.y===!0&&(n.yValue=n.yValueList.length),t=(null===u.y[n.yField.join("/")]||void 0===u.y[n.yField.join("/")]?0:u.y[n.yField.join("/")])+(e.x._hasMeasure()?Math.abs(n.xValue):0),u.y[n.yField.join("/")]=t),null!==e.z&&(s.z===!0&&(n.zValue=n.zValueList.length),t=(null===u.z[n.zField.join("/")]||void 0===u.z[n.zField.join("/")]?0:u.z[n.zField.join("/")])+(e.z._hasMeasure()?Math.abs(n.zValue):0),u.z[n.zField.join("/")]=t),null!==e.c&&((null===a.min||n.cValue<a.min)&&(a.min=n.cValue),(null===a.max||n.cValue>a.max)&&(a.max=n.cValue))},this);for(n in u.x)u.x.hasOwnProperty(n)&&(h.x+=u.x[n]);for(n in u.y)u.y.hasOwnProperty(n)&&(h.y+=u.y[n]);for(n in u.z)u.z.hasOwnProperty(n)&&(h.z+=u.z[n]);r.forEach(function(t){var n,r,i,s,p,d=function(n,r,i){var s,a,p,d,v;null!==n&&void 0!==n&&(d=n.position,n._hasCategories()?n._hasMeasure()?(s=t[n.position+"Field"].join("/"),a=n.showPercent?u[n.position][s]/h[n.position]:u[n.position][s],-1===l.indexOf(s)&&(c[s]=a+(l.length>0?c[l[l.length-1]]:0),l.push(s)),p=t[d+"Bound"]=t["c"+d]="x"!==d&&"y"!==d||!e.stacked?a:c[s],t[i]=a,t[d]=p-("x"===d&&a>=0||"y"===d&&0>=a?a:0)):(t[d]=t["c"+d]=t[d+"Field"][0],t[i]=1,void 0!==o[d]&&null!==o[d]&&o[d].length>=2&&(t[d+"Offset"]=o[d].indexOf(t[d+"Field"][1]),t[i]=1/o[d].length)):(a=n.showPercent?t[d+"Value"]/u[r][t[r+"Field"].join("/")]:t[d+"Value"],s=t[r+"Field"].join("/")+(t[d+"Value"]>=0),v=f[d][s]=(null===f[d][s]||void 0===f[d][s]||"z"===d?0:f[d][s])+a,p=t[d+"Bound"]=t["c"+d]="x"!==d&&"y"!==d||!e.stacked?a:v,t[i]=a,t[d]=p-("x"===d&&a>=0||"y"===d&&0>=a?a:0)))};d(e.x,"y","width"),d(e.y,"x","height"),d(e.z,"z","r"),null!==e.c&&null!==a.min&&null!==a.max&&(a.min===a.max&&(a.min-=.5,a.max+=.5),a.min=null!==e.c.overrideMin&&void 0!==e.c.overrideMin?e.c.overrideMin:a.min,a.max=null!==e.c.overrideMax&&void 0!==e.c.overrideMax?e.c.overrideMax:a.max,t.cValue=t.cValue>a.max?a.max:t.cValue<a.min?a.min:t.cValue,i=d3.scale.linear().range([0,null===e.c.colors||1===e.c.colors.length?1:e.c.colors.length-1]).domain([a.min,a.max]),s=i(t.cValue),p=s-Math.floor(s),t.cValue===a.max&&(p=1),null!==e.c.colors&&void 0!==e.c.colors&&1===e.c.colors.length?(n=d3.rgb(e.c.colors[0]),r=d3.rgb(this.getColor(t.aggField.slice(-1)[0]).fill)):null!==e.c.colors&&void 0!==e.c.colors&&e.c.colors.length>1?(n=d3.rgb(e.c.colors[Math.floor(s)]),r=d3.rgb(e.c.colors[Math.ceil(s)])):(n=d3.rgb("white"),r=d3.rgb(this.getColor(t.aggField.slice(-1)[0]).fill)),n.r=Math.floor(n.r+(r.r-n.r)*p),n.g=Math.floor(n.g+(r.g-n.g)*p),n.b=Math.floor(n.b+(r.b-n.b)*p),t.fill=n.toString(),t.stroke=n.darker(.5).toString())},this),e._positionData=r},this)},this._heightPixels=function(){return dimple._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(e){null!==e._eventHandlers&&e._eventHandlers.length>0&&e._eventHandlers.forEach(function(t){null!==t.handler&&"function"==typeof t.handler&&e.shapes.on(t.event,function(n){var r=new dimple.eventArgs;null!==e.chart.storyboard&&(r.frameValue=e.chart.storyboard.getFrameValue()),r.seriesValue=n.aggField,r.xValue=n.x,r.yValue=n.y,r.zValue=n.z,r.colorValue=n.cValue,r.seriesShapes=e.shapes,r.selectedShape=d3.select(this),t.handler(r)})},this)},this._widthPixels=function(){return dimple._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return dimple._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return dimple._parseYPosition(this.y,this.svg.node())},this.addAxis=function(e,t,n,r){null!==t&&void 0!==t&&(t=[].concat(t));var i=new dimple.axis(this,e,t,n,r);return this.axes.push(i),i},this.addCategoryAxis=function(e,t){return this.addAxis(e,t,null)},this.addColorAxis=function(e,t){var n=this.addAxis("c",null,e);return n.colors=null===t||void 0===t?null:[].concat(t),n},this.addLegend=function(e,t,n,r,i,s){s=null===s||void 0===s?this.series:[].concat(s),i=null===i||void 0===i?"left":i;var o=new dimple.legend(this,e,t,n,r,i,s);return this.legends.push(o),o},this.addLogAxis=function(e,t,n){var r=this.addAxis(e,null,t,null);return null!==n&&void 0!==n&&(r.logBase=n),r.useLog=!0,r},this.addMeasureAxis=function(e,t){return this.addAxis(e,null,t)},this.addPctAxis=function(e,t,n){var r=null;return r=null!==n&&void 0!==n?this.addAxis(e,n,t):this.addMeasureAxis(e,t),r.showPercent=!0,r},this.addSeries=function(e,t,n){(null===n||void 0===n)&&(n=this.axes),(null===t||void 0===t)&&(t=dimple.plot.bubble);var r,i=null,s=null,o=null,u=null;return n.forEach(function(e){null!==e&&t.supportedAxes.indexOf(e.position)>-1&&(null===i&&"x"===e.position[0]?i=e:null===s&&"y"===e.position[0]?s=e:null===o&&"z"===e.position[0]?o=e:null===u&&"c"===e.position[0]&&(u=e))},this),null!==e&&void 0!==e&&(e=[].concat(e)),r=new dimple.series(this,e,i,s,o,u,t,dimple.aggregateMethod.sum,t.stacked),this.series.push(r),r},this.addTimeAxis=function(e,t,n,r){var i=this.addAxis(e,null,null,t);return i.tickFormat=r,i.dateParseFormat=n,i},this.assignColor=function(e,t,n,r){return this._assignedColors[e]=new dimple.color(t,n,r),this._assignedColors[e]},this.defaultColors=[new dimple.color("#80B1D3"),new dimple.color("#FB8072"),new dimple.color("#FDB462"),new dimple.color("#B3DE69"),new dimple.color("#FFED6F"),new dimple.color("#BC80BD"),new dimple.color("#8DD3C7"),new dimple.color("#CCEBC5"),new dimple.color("#FFFFB3"),new dimple.color("#BEBADA"),new dimple.color("#FCCDE5"),new dimple.color("#D9D9D9")],this.draw=function(e,t){e=null===e||void 0===e?0:e;var n,r=null,i=null,s=!1,o=!1,u=this._xPixels(),a=this._yPixels(),f=this._widthPixels(),l=this._heightPixels();return(void 0===t||null===t||t===!1)&&this._getSeriesData(),this.axes.forEach(function(e){if(e._min=0,e._max=0,e._hasMeasure()){var t=!1;this.series.forEach(function(n){if(n[e.position]===e){var r=n._axisBounds(e.position);e._min>r.min&&(e._min=r.min),e._max<r.max&&(e._max=r.max),t=!0}},this),t||this.data.forEach(function(t){e._min>t[e.measure]&&(e._min=t[e.measure]),e._max<t[e.measure]&&(e._max=t[e.measure])},this)}else e._hasTimeField()?(e._min=null,e._max=null,this.data.forEach(function(t){var n=e._parseDate(t[e.timeField]);(null===e._min||n<e._min)&&(e._min=n),(null===e._max||n>e._max)&&(e._max=n)},this)):e._hasCategories()&&(e._min=0,n=[],this.data.forEach(function(t){-1===n.indexOf(t[e.categoryFields[0]])&&n.push(t[e.categoryFields[0]])},this),e._max=n.length);e._update(),null===r&&"x"===e.position?r=e:null===i&&"y"===e.position&&(i=e)},this),this.axes.forEach(function(t){var n,c=!1,p=null,v=0,m=null,y=!1,b=0,w={l:null,t:null,r:null,b:null},E=0,S=0,x="",T=this;null===t.gridlineShapes?(t.showGridlines||null===t.showGridlines&&!t._hasCategories()&&(!s&&"x"===t.position||!o&&"y"===t.position))&&(t.gridlineShapes=this._group.append("g").attr("class","gridlines"),"x"===t.position?s=!0:o=!0):"x"===t.position?s=!0:o=!0,null===t.shapes&&(t.shapes=this._group.append("g").attr("class","axis"),c=!0),t===r&&null!==i?(p="translate(0, "+(null===i.categoryFields||0===i.categoryFields.length?i._scale(0):a+l)+")",m="translate(0, "+(t===r?a+l:a)+")",v=-l):t===i&&null!==r?(p="translate("+(null===r.categoryFields||0===r.categoryFields.length?r._scale(0):u)+", 0)",m="translate("+(t===i?u:u+f)+", 0)",v=-f):"x"===t.position?(m=p="translate(0, "+(t===r?a+l:a)+")",v=-l):"y"===t.position&&(m=p="translate("+(t===i?u:u+f)+", 0)",v=-f),n=function(t){var n;return n=null===p||0===e||c?t:t.transition().duration(e)},null!==p&&null!==t._draw&&(t._hasTimeField()?n(t.shapes).call(t._draw.ticks(t._getTimePeriod(),t.timeInterval).tickFormat(t._getFormat())).attr("transform",p):t.useLog?n(t.shapes).call(t._draw.ticks(4,t._getFormat())).attr("transform",p):n(t.shapes).call(t._draw.tickFormat(t._getFormat())).attr("transform",p),null!==t.gridlineShapes&&n(t.gridlineShapes).call(t._draw.tickSize(v,0,0).tickFormat("")).attr("transform",m),(null===t.measure||void 0===t.measure)&&("x"===t.position?n(t.shapes.selectAll("text")).attr("x",f/t._max/2):"y"===t.position&&n(t.shapes.selectAll("text")).attr("y",-1*(l/t._max)/2)),null!==t.categoryFields&&void 0!==t.categoryFields&&t.categoryFields.length>0&&(t!==r||null!==i.categoryFields&&0!==i.categoryFields.length||n(t.shapes.selectAll("text")).attr("y",a+l-i._scale(0)+9),t!==i||null!==r.categoryFields&&0!==r.categoryFields.length||n(t.shapes.selectAll("text")).attr("x",-1*(r._scale(0)-u)-9))),this.noFormats||(n(t.shapes.selectAll("text")).style("font-family","sans-serif").style("font-size",(l/35>10?l/35:10)+"px"),n(t.shapes.selectAll("path, line")).style("fill","none").style("stroke","black").style("shape-rendering","crispEdges"),null!==t.gridlineShapes&&n(t.gridlineShapes.selectAll("line")).style("fill","none").style("stroke","lightgray").style("opacity",.8)),(null===t.measure||void 0===t.measure)&&(t===r?(b=0,t.shapes.selectAll("text").each(function(){var e=this.getComputedTextLength();b=e>b?e:b}),b>f/t.shapes.selectAll("text")[0].length?(y=!0,t.shapes.selectAll("text").style("text-anchor","start").each(function(){var e=this.getBBox();d3.select(this).attr("transform","rotate(90,"+e.x+","+(e.y+e.height/2)+") translate(-5, 0)")})):(y=!1,t.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===t.position&&(b=0,t.shapes.selectAll("text").each(function(){var e=this.getComputedTextLength();b=e>b?e:b}),b>f/t.shapes.selectAll("text")[0].length?(y=!0,t.shapes.selectAll("text").style("text-anchor","end").each(function(){var e=this.getBBox();d3.select(this).attr("transform","rotate(90,"+(e.x+e.width)+","+(e.y+e.height/2)+") translate(5, 0)")})):(y=!1,t.shapes.selectAll("text").style("text-anchor","middle").attr("transform","")))),null!==t.titleShape&&void 0!==t.titleShape&&t.titleShape.remove(),t.shapes.selectAll("text").each(function(){var e=this.getBBox();(null===w.l||-9-e.width<w.l)&&(w.l=-9-e.width),(null===w.r||e.x+e.width>w.r)&&(w.r=e.x+e.width),y?((null===w.t||e.y+e.height-e.width<w.t)&&(w.t=e.y+e.height-e.width),(null===w.b||e.height+e.width>w.b)&&(w.b=e.height+e.width)):((null===w.t||e.y<w.t)&&(w.t=e.y),(null===w.b||9+e.height>w.b)&&(w.b=9+e.height))}),"x"===t.position?(S=t===r?a+l+w.b+5:a+w.t-10,E=u+f/2):"y"===t.position&&(E=t===i?u+w.l-10:u+f+w.r+20,S=a+l/2,x="rotate(270, "+E+", "+S+")"),t.hidden||"x"!==t.position&&"y"!==t.position||(t.titleShape=this._group.append("text").attr("class","axis title"),t.titleShape.attr("x",E).attr("y",S).attr("text-anchor","middle").attr("transform",x).text(null===t.categoryFields||void 0===t.categoryFields||0===t.categoryFields.length?t.measure:t.categoryFields.join("/")).each(function(){T.noFormats||d3.select(this).style("font-family","sans-serif").style("font-size",(l/35>10?l/35:10)+"px")}),t===r?t.titleShape.each(function(){d3.select(this).attr("y",S+this.getBBox().height/1.65)}):t===i&&t.titleShape.each(function(){d3.select(this).attr("x",E+this.getBBox().height/1.65)}))},this),this.series.forEach(function(t){t.plot.draw(this,t,e),this._registerEventHandlers(t)},this),this.legends.forEach(function(t){t._draw(e)},this),null!==this.storyboard&&void 0!==this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay&&this.storyboard.startAnimation()),this},this.getColor=function(e){return(null===this._assignedColors[e]||void 0===this._assignedColors[e])&&(this._assignedColors[e]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[e]},this.setBounds=function(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this._xPixels=function(){return dimple._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return dimple._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return dimple._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return dimple._parseYPosition(this.height,this.svg.node())},this.draw(0,!0),this},this.setMargins=function(e,t,n,r){return this.x=e,this.y=t,this.width=0,this.height=0,this._xPixels=function(){return dimple._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return dimple._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return dimple._parentWidth(this.svg.node())-this._xPixels()-dimple._parseXPosition(n,this.svg.node())},this._heightPixels=function(){return dimple._parentHeight(this.svg.node())-this._yPixels()-dimple._parseYPosition(r,this.svg.node())},this.draw(0,!0),this},this.setStoryboard=function(e,t){return this.storyboard=new dimple.storyboard(this,e),null!==t&&void 0!==t&&(this.storyboard.onTick=t),this.storyboard}},dimple.color=function(e,t,n){this.fill=e,this.stroke=null===t||void 0===t?d3.rgb(e).darker(.5).toString():t,this.opacity=null===n||void 0===n?.8:n},dimple.eventArgs=function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null},dimple.legend=function(e,t,n,r,i,s,o){this.chart=e,this.series=o,this.x=t,this.y=n,this.width=r,this.height=i,this.horizontalAlign=s,this.shapes=null,this._draw=function(e){var t,n=this._getEntries(),r=0,i=0,s=0,o=0,u=15,a=9,f=this;null!==this.shapes&&void 0!==this.shapes&&this.shapes.transition().duration(.2*e).attr("opacity",0).remove(),t=this.chart._group.selectAll(".dontSelectAny").data(n).enter().append("g").attr("class","legend").attr("opacity",0),t.append("text").attr("id",function(e){return"legend_"+e.key}).attr("class","legendText").text(function(e){return e.key}).call(function(){f.chart.noFormats||this.style("font-family","sans-serif").style("font-size",(f.chart._heightPixels()/35>10?f.chart._heightPixels()/35:10)+"px").style("shape-rendering","crispEdges")}).each(function(){var e=this.getBBox();e.width>r&&(r=e.width),e.height>i&&(i=e.height)}),t.append("rect").attr("class","legendKey").attr("height",a).attr("width",u),i=(a>i?a:i)+2,r+=u+20,t.each(function(e){s+r>f._widthPixels()&&(s=0,o+=i),o>f._heightPixels()?d3.select(this).remove():(d3.select(this).select("text").attr("x","left"===f.horizontalAlign?f._xPixels()+u+5+s:f._xPixels()+(f._widthPixels()-s-r)+u+5).attr("y",function(){return f._yPixels()+o+this.getBBox().height/1.65}).attr("width",f._widthPixels()).attr("height",f._heightPixels()),d3.select(this).select("rect").attr("class","legend legendKey").attr("x","left"===f.horizontalAlign?f._xPixels()+s:f._xPixels()+(f._widthPixels()-s-r)).attr("y",f._yPixels()+o).attr("height",a).attr("width",u).style("fill",function(){return dimple._helpers.fill(e,f.chart,e.series)}).style("stroke",function(){return dimple._helpers.stroke(e,f.chart,e.series)}).style("opacity",function(){return dimple._helpers.opacity(e,f.chart,e.series)}).style("shape-rendering","crispEdges"),s+=r)}),t.transition().delay(.2*e).duration(.8*e).attr("opacity",1),this.shapes=t},this._getEntries=function(){var e=[];return null!==this.series&&void 0!==this.series&&this.series.forEach(function(t){var n=t._positionData;n.forEach(function(n){var r,i=-1;for(r=0;r<e.length;r+=1)if(e[r].key===n.aggField.slice(-1)[0]){i=r;break}-1===i&&(e.push({key:n.aggField.slice(-1)[0],fill:n.fill,stroke:n.stroke,series:t,aggField:n.aggField}),i=e.length-1)})},this),e},this._heightPixels=function(){return dimple._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return dimple._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return dimple._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return dimple._parseYPosition(this.y,this.chart.svg.node())}},dimple.series=function(e,t,n,r,i,s,o,u,a){this.chart=e,this.x=n,this.y=r,this.z=i,this.c=s,this.plot=o,this.categoryFields=t,this.aggregate=u,this.stacked=a,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(e){var t,n,r,i={min:0,max:0},s=null,o=null,u=[],a=0,f=this._positionData;return"x"===e?(s=this.x,o=this.y):"y"===e?(s=this.y,o=this.x):"z"===e?s=this.z:"c"===e&&(s=this.c),s.showPercent?f.forEach(function(e){e[s.position+"Bound"]<i.min&&(i.min=e[s.position+"Bound"]),e[s.position+"Bound"]>i.max&&(i.max=e[s.position+"Bound"])},this):null===o||null===o.categoryFields||0===o.categoryFields.length?f.forEach(function(e){!this.stacked||"x"!==s.position&&"y"!==s.position?(e[s.position+"Value"]<i.min&&(i.min=e[s.position+"Value"]),e[s.position+"Value"]>i.max&&(i.max=e[s.position+"Value"])):e[s.position+"Value"]<0?i.min=i.min+e[s.position+"Value"]:i.max=i.max+e[s.position+"Value"]},this):(t=s.position+"Value",n=o.position+"Field",r=[],f.forEach(function(e){var i=e[n].join("/"),s=r.indexOf(i);-1===s&&(r.push(i),s=r.length-1),void 0===u[s]&&(u[s]={min:0,max:0},s>=a&&(a=s+1)),this.stacked?e[t]<0?u[s].min=u[s].min+e[t]:u[s].max=u[s].max+e[t]:(e[t]<u[s].min&&(u[s].min=e[t]),e[t]>u[s].max&&(u[s].max=e[t]))},this),u.forEach(function(e){void 0!==e&&(e.min<i.min&&(i.min=e.min),e.max>i.max&&(i.max=e.max))},this)),i},this._dropLineOrigin=function(){var e=0,t=0,n={x:null,y:null},r={x:null,y:null};return this.chart.axes.forEach(function(e){"x"===e.position&&null===r.x?r.x=e._hasTimeField()?this.chart._xPixels():e._origin:"y"===e.position&&null===r.y&&(r.y=e._hasTimeField()?this.chart._yPixels()+this.chart._heightPixels():e._origin)},this),this.chart.axes.forEach(function(i){"x"!==i.position||this.x.hidden?"y"!==i.position||this.y.hidden||(i===this.y&&(0===t?n.x=r.x:1===t&&(n.x=this.chart._xPixels()+this.chart._widthPixels())),t+=1):(i===this.x&&(0===e?n.y=r.y:1===e&&(n.y=this.chart._yPixels())),e+=1)},this),n},this.addEventHandler=function(e,t){this._eventHandlers.push({event:e,handler:t})},this.addOrderRule=function(e,t){this._orderRules.push({ordering:e,desc:t})}},dimple.storyboard=function(e,t){null!==t&&void 0!==t&&(t=[].concat(t)),this.chart=e,this.categoryFields=t,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(e){if(null===this.storyLabel||void 0===this.storyLabel){var t=this.chart,n=0;this.chart.axes.forEach(function(e){"x"===e.position&&(n+=1)},this),this.storyLabel=this.chart._group.append("text").attr("x",this.chart._xPixels()+.01*this.chart._widthPixels()).attr("y",this.chart._yPixels()+(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)*(n>1?1.25:-1)).call(function(){t.noFormats||this.style("font-family","sans-serif").style("font-size",(t._heightPixels()/35>10?t._heightPixels()/35:10)+"px")})}this.storyLabel.transition().duration(.2*e).attr("opacity",0),this.storyLabel.transition().delay(.2*e).text(this.categoryFields.join("\\")+": "+this.getFrameValue()).transition().duration(.8*e).attr("opacity",1)},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart.data.forEach(function(e){var t=-1,n="";null!==this.categoryFields&&(this.categoryFields.forEach(function(t,r){r>0&&(n+="/"),n+=e[t]},this),t=this._categories.indexOf(n),-1===t&&(this._categories.push(n),t=this._categories.length-1))},this),this._cachedCategoryFields=this._categoryFields),this._categories},this._goToFrameIndex=function(e){this._frame=e%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(e,t){this._orderRules.push({ordering:e,desc:t})},this.getFrameValue=function(){var e=null;return this._frame>=0&&this._getCategories().length>this._frame&&(e=this._getCategories()[this._frame]),e},this.goToFrame=function(e){if(this._getCategories().length>0){var t=this._getCategories().indexOf(e);this._goToFrameIndex(t)}},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval(function(e){return function(){e._goToFrameIndex(e._frame+1),null!==e.onTick&&e.onTick(e.getFrameValue()),e._drawText(e.frameDuration/2)}}(this),this.frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}},dimple.aggregateMethod.avg=function(e,t){return e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),e.count=null===e.count||void 0===e.count?1:parseFloat(e.count),t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),t.count=null===t.count||void 0===t.count?1:parseFloat(t.count),(e.value*e.count+t.value*t.count)/(e.count+t.count)},dimple.aggregateMethod.count=function(e,t){return e.count=null===e.count||void 0===e.count?0:parseFloat(e.count),t.count=null===t.count||void 0===t.count?0:parseFloat(t.count),e.count+t.count},dimple.aggregateMethod.max=function(e,t){return e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value>t.value?e.value:t.value},dimple.aggregateMethod.min=function(e,t){return null===e.value?parseFloat(t.value):parseFloat(e.value)<parseFloat(t.value)?parseFloat(e.value):parseFloat(t.value)},dimple.aggregateMethod.sum=function(e,t){return e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value+t.value},dimple.plot.area={stacked:!0,supportedAxes:["x","y","c"],draw:function(e,t,n){var r,i,s=this,o=t._positionData,u=[],a=1,f=!1,l={};null!==e._tooltipGroup&&void 0!==e._tooltipGroup&&e._tooltipGroup.remove(),(t.x._hasCategories()||t.y._hasCategories())&&(a=0),o.forEach(function(e){var t,n=[],r=!1;for(t=a;t<e.aggField.length;t+=1)n.push(e.aggField[t]);u.forEach(function(e){r=r||e===n.join("/")},this),r||u.push(n.join("/"))},this),null!==t.c&&void 0!==t.c&&(t.x._hasCategories()&&t.y._hasMeasure()||t.y._hasCategories()&&t.x._hasMeasure())&&(f=!0,u.forEach(function(r){dimple._addGradient(r,"fill-area-gradient-"+r.join("_").replace(" ",""),t.x._hasCategories()?t.x:t.y,o,e,n,"fill"),dimple._addGradient(r,"stroke-area-gradient-"+r.join("_").replace(" ",""),t.x._hasCategories()?t.x:t.y,o,e,n,"stroke")},this)),r=d3.svg.line().x(function(n){return dimple._helpers.cx(n,e,t)}).y(function(n){return dimple._helpers.cy(n,e,t)}),(null===t.shapes||void 0===t.shapes)&&(t.shapes=e._group.selectAll(".area").data(u).enter().append("svg:path").attr("opacity",function(t){return e.getColor(t).opacity})),t.shapes.data(u).transition().duration(n).attr("class",function(e){return"series area "+e.replace(" ","")}).attr("d",function(n){var i,s,u,a,f,c,h,p,v=[],m=0;for(i=dimple.filterData(o,"aggField",n),i.sort(function(n,r){var i=0;return t.x._hasCategories()?i=dimple._helpers.cx(n,e,t)<dimple._helpers.cx(r,e,t)?-1:1:t.y._hasCategories()&&(i=dimple._helpers.cy(n,e,t)<dimple._helpers.cy(r,e,t)?-1:1),i}),a=i.length-1;a>=0;a-=1)if(s=i[a],u={cx:0,cy:0,height:0,width:0,xOffset:0,yOffset:0},t.x._hasCategories()){if(u.cx=s.cx,u.width=s.width,u.xOffset=s.xOffset,void 0===l[s.xField])l[s.xField]=[];else{for(m=0,f=0;f<=l[s.xField].length;f+=1)h=l[s.xField][f],(s.cy>=0&&h>=0||s.cy<=0&&0>=h)&&Math.abs(h)<=Math.abs(s.cy)&&Math.abs(h)>Math.abs(m)&&(m=h);u.cy=m}v.push(u),l[s.xField].push(s.cy)}else if(t.y._hasCategories()){if(u.cy=s.cy,u.height=s.height,u.yOffset=s.yOffset,void 0===l[s.yField])l[s.yField]=[];else{for(m=0,c=0;c<=l[s.yField].length;c+=1)p=l[s.yField][c],(s.cx>=0&&p>=0||s.cx<=0&&0>=p)&&Math.abs(p)<=Math.abs(s.cx)&&Math.abs(p)>Math.abs(m)&&(m=p);u.cx=m}v.push(u),l[s.yField].push(s.cx)}return r(i.concat(v).concat(i[0]))}).call(function(){e.noFormats||this.attr("fill",function(t){return f?"url(#fill-area-gradient-"+t.join("_").replace(" ","")+")":e.getColor(t).fill}).attr("stroke",function(t){return f?"url(#stroke-area-gradient-"+t.join("_").replace(" ","")+")":e.getColor(t).stroke}).attr("stroke-width",t.lineWeight)}),i=e._group.selectAll(".markers").data(o).enter(),t.lineMarkers&&i.append("circle").transition().duration(n).attr("cx",function(n){return dimple._helpers.cx(n,e,t)}).attr("cy",function(n){return dimple._helpers.cy(n,e,t)}).attr("r",2+t.lineWeight).attr("fill","white").attr("stroke","none"),i.append("circle").on("mouseover",function(n){s.enterEventHandler(n,this,e,t)}).on("mouseleave",function(n){s.leaveEventHandler(n,this,e,t)}).transition().duration(n).attr("cx",function(n){return dimple._helpers.cx(n,e,t)}).attr("cy",function(n){return dimple._helpers.cy(n,e,t)}).attr("r",2+t.lineWeight).attr("opacity",function(n){return t.lineMarkers?e.getColor(n).opacity:0}).call(function(){e.noFormats||this.attr("fill","white").style("stroke-width",t.lineWeight).attr("stroke",function(n){return dimple._helpers.stroke(n,e,t)})})},enterEventHandler:function(e,t,n,r){var i,s,o,u=5,a=10,f=750,l=d3.select(t),c=parseFloat(l.attr("cx")),h=parseFloat(l.attr("cy")),p=parseFloat(l.attr("r")),d=dimple._helpers.opacity(e,n,r),v=dimple._helpers.fill(e,n,r),m=r._dropLineOrigin(),g=d3.rgb(d3.rgb(v).r+.6*(255-d3.rgb(v).r),d3.rgb(v).g+.6*(255-d3.rgb(v).g),d3.rgb(v).b+.6*(255-d3.rgb(v).b)),y=d3.rgb(d3.rgb(v).r+.8*(255-d3.rgb(v).r),d3.rgb(v).g+.8*(255-d3.rgb(v).g),d3.rgb(v).b+.8*(255-d3.rgb(v).b)),b=0,w=0,E=0,S=[];null!==n._tooltipGroup&&void 0!==n._tooltipGroup&&n._tooltipGroup.remove(),n._tooltipGroup=n.svg.append("g"),l.style("opacity",1),n._tooltipGroup.append("circle").attr("cx",c).attr("cy",h).attr("r",p).attr("opacity",0).style("fill","none").style("stroke",v).style("stroke-width",1).transition().duration(f/2).ease("linear").attr("opacity",1).attr("r",p+4).style("stroke-width",2),null!==m.y&&n._tooltipGroup.append("line").attr("x1",c).attr("y1",h<m.y?h+p+4:h-p-4).attr("x2",c).attr("y2",h<m.y?h+p+4:h-p-4).style("fill","none").style("stroke",v).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",d).transition().delay(f/2).duration(f/2).ease("linear").attr("y2",h<m.y?m.y-1:m.y+1),null!==m.x&&n._tooltipGroup.append("line").attr("x1",c<m.x?c+p+4:c-p-4).attr("y1",h).attr("x2",c<m.x?c+p+4:c-p-4).attr("y2",h).style("fill","none").style("stroke",v).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",d).transition().delay(f/2).duration(f/2).ease("linear").attr("x2",c<m.x?m.x-1:m.x+1),i=n._tooltipGroup.append("g"),s=i.append("rect"),null!==r.categoryFields&&void 0!==r.categoryFields&&r.categoryFields.length>0&&r.categoryFields.forEach(function(t,n){S.push(t+(e.aggField[n]!==t?": "+e.aggField[n]:""))},this),r.x._hasTimeField()?S.push(r.x.timeField+": "+r.x._getFormat()(e.xField[0])):r.x._hasCategories()?r.x.categoryFields.forEach(function(t,n){S.push(t+(e.xField[n]!==t?": "+e.xField[n]:""))},this):S.push(r.x.measure+": "+r.x._getFormat()(e.width)),r.y._hasTimeField()?S.push(r.y.timeField+": "+r.y._getFormat()(e.yField[0])):r.y._hasCategories()?r.y.categoryFields.forEach(function(t,n){S.push(t+(e.yField[n]!==t?": "+e.yField[n]:""))},this):S.push(r.y.measure+": "+r.y._getFormat()(e.height)),null!==r.z&&void 0!==r.z&&S.push(r.z.measure+": "+r.z._getFormat()(e.zValue)),null!==r.c&&void 0!==r.c&&S.push(r.c.measure+": "+r.c._getFormat()(e.cValue)),S=S.filter(function(e,t){return S.indexOf(e)===t}),i.selectAll(".textHoverShapes").data(S).enter().append("text").text(function(e){return e}).style("font-family","sans-serif").style("font-size","10px"),i.each(function(){w=this.getBBox().width>w?this.getBBox().width:w,E=this.getBBox().width>E?this.getBBox().height:E}),i.selectAll("text").attr("x",0).attr("y",function(){return b+=this.getBBox().height,b-this.getBBox().height/2}),s.attr("x",-u).attr("y",-u).attr("height",Math.floor(b+u)-.5).attr("width",w+2*u).attr("rx",5).attr("ry",5).style("fill",y).style("stroke",g).style("stroke-width",2).style("opacity",.95),o=c+p+u+a+w>parseFloat(n.svg.attr("width")),i.attr("transform","translate("+(o?c-(p+u+a+w):c+p+u+a)+" , "+(h-(b-(E-u))/2)+")")},leaveEventHandler:function(e,t,n,r){d3.select(t).style("opacity",r.lineMarkers?dimple._helpers.opacity(e,n,r):0),null!==n._tooltipGroup&&void 0!==n._tooltipGroup&&n._tooltipGroup.remove()}},dimple.plot.bar={stacked:!0,supportedAxes:["x","y","c"],draw:function(e,t,n){var r=this,i=t._positionData,s=null,o="series"+e.series.indexOf(t);null!==e._tooltipGroup&&void 0!==e._tooltipGroup&&e._tooltipGroup.remove(),s=null===t.shapes||void 0===t.shapes?e._group.selectAll("."+o).data(i):t.shapes.data(i,function(e){return e.key}),s.enter().append("rect").attr("id",function(e){return e.key}).attr("class",function(e){return o+" bar "+e.aggField.join(" ")+" "+e.xField.join(" ")+" "+e.yField.join(" ")}).attr("x",function(n){return dimple._helpers.x(n,e,t)}).attr("y",function(n){return dimple._helpers.y(n,e,t)+dimple._helpers.height(n,e,t)}).attr("width",function(n){return null!==n.xField&&n.xField.length>0?dimple._helpers.width(n,e,t):0}).attr("height",function(n){return null!==n.yField&&n.yField.length>0?dimple._helpers.height(n,e,t):0}).attr("opacity",function(n){return dimple._helpers.opacity(n,e,t)}).on("mouseover",function(n){r.enterEventHandler(n,this,e,t)}).on("mouseleave",function(){r.leaveEventHandler(e)}).call(function(){e.noFormats||this.attr("fill",function(n){return dimple._helpers.fill(n,e,t)}).attr("stroke",function(n){return dimple._helpers.stroke(n,e,t)})}),s.transition().duration(n).attr("x",function(n){return dimple._helpers.x(n,e,t)}).attr("y",function(n){return dimple._helpers.y(n,e,t)}).attr("width",function(n){return dimple._helpers.width(n,e,t)}).attr("height",function(n){return dimple._helpers.height(n,e,t)}).call(function(){e.noFormats||this.attr("fill",function(n){return dimple._helpers.fill(n,e,t)}).attr("stroke",function(n){return dimple._helpers.stroke(n,e,t)})}),s.exit().transition().duration(n).attr("x",function(n){return dimple._helpers.x(n,e,t)}).attr("y",function(n){return dimple._helpers.y(n,e,t)}).attr("width",function(n){return dimple._helpers.width(n,e,t)}).attr("height",function(n){return dimple._helpers.height(n,e,t)}).each("end",function(){d3.select(this).remove()}),t.shapes=s},enterEventHandler:function(e,t,n,r){var i,s,o=5,u=10,a=750,f=d3.select(t),l=parseFloat(f.attr("x")),c=parseFloat(f.attr("y")),h=parseFloat(f.attr("width")),p=parseFloat(f.attr("height")),d=f.attr("opacity"),v=f.attr("fill"),m=r._dropLineOrigin(),g=d3.rgb(d3.rgb(v).r+.6*(255-d3.rgb(v).r),d3.rgb(v).g+.6*(255-d3.rgb(v).g),d3.rgb(v).b+.6*(255-d3.rgb(v).b)),y=d3.rgb(d3.rgb(v).r+.8*(255-d3.rgb(v).r),d3.rgb(v).g+.8*(255-d3.rgb(v).g),d3.rgb(v).b+.8*(255-d3.rgb(v).b)),b=[],w=0,E=0,S=0;null!==n._tooltipGroup&&void 0!==n._tooltipGroup&&n._tooltipGroup.remove(),n._tooltipGroup=n.svg.append("g"),r.x._hasCategories()||null===m.y||n._tooltipGroup.append("line").attr("x1",l<r.x._origin?l+1:l+h-1).attr("y1",c<m.y?c+p:c).attr("x2",l<r.x._origin?l+1:l+h-1).attr("y2",c<m.y?c+p:c).style("fill","none").style("stroke",v).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",d).transition().delay(a/2).duration(a/2).ease("linear").attr("y2",c<m.y?m.y-1:m.y+1),r.y._hasCategories()||null===m.x||n._tooltipGroup.append("line").attr("x1",l<m.x?l+h:l).attr("y1",c<r.y._origin?c+1:c+p-1).attr("x2",l<m.x?l+h:l).attr("y2",c<r.y._origin?c+1:c+p-1).style("fill","none").style("stroke",v).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",d).transition().delay(a/2).duration(a/2).ease("linear").attr("x2",l<m.x?m.x-1:m.x+1),i=n._tooltipGroup.append("g"),s=i.append("rect"),null!==r.categoryFields&&void 0!==r.categoryFields&&r.categoryFields.length>0&&r.categoryFields.forEach(function(t,n){b.push(t+(e.aggField[n]!==t?": "+e.aggField[n]:""))},this),r.x._hasTimeField()?b.push(r.x.timeField+": "+r.x._getFormat()(e.xField[0])):r.x._hasCategories()?r.x.categoryFields.forEach(function(t,n){b.push(t+(e.xField[n]!==t?": "+e.xField[n]:""))},this):b.push(r.x.measure+": "+r.x._getFormat()(e.width)),r.y._hasTimeField()?b.push(r.y.timeField+": "+r.y._getFormat()(e.yField[0])):r.y._hasCategories()?r.y.categoryFields.forEach(function(t,n){b.push(t+(e.yField[n]!==t?": "+e.yField[n]:""))},this):b.push(r.y.measure+": "+r.y._getFormat()(e.height)),null!==r.c&&void 0!==r.c&&b.push(r.c.measure+": "+r.c._getFormat()(r.c.showPercent?e.cPct:e.cValue)),b=b.filter(function(e,t){return b.indexOf(e)===t}),i.selectAll(".textHoverShapes").data(b).enter().append("text").text(function(e){return e}).style("font-family","sans-serif").style("font-size","10px"),i.each(function(){E=this.getBBox().width>E?this.getBBox().width:E,S=this.getBBox().width>S?this.getBBox().height:S}),i.selectAll("text").attr("x",0).attr("y",function(){return w+=this.getBBox().height,w-this.getBBox().height/2}),s.attr("x",-o).attr("y",-o).attr("height",Math.floor(w+o)-.5).attr("width",E+2*o).attr("rx",5).attr("ry",5).style("fill",y).style("stroke",g).style("stroke-width",2).style("opacity",.95),l+h+o+u+E<parseFloat(n.svg.attr("width"))?i.attr("transform","translate("+(l+h+o+u)+" , "+(c+p/2-(w-(S-o))/2)+")"):l-(o+u+E)>0?i.attr("transform","translate("+(l-(o+u+E))+" , "+(c+p/2-(w-(S-o))/2)+")"):c+p+w+u+o<parseFloat(n.svg.attr("height"))?i.attr("transform","translate("+(l+h/2-(2*o+E)/2)+" , "+(c+p+2*o)+")"):i.attr("transform","translate("+(l+h/2-(2*o+E)/2)+" , "+(c-w-(S-o))+")")},leaveEventHandler:function(e){null!==e._tooltipGroup&&void 0!==e._tooltipGroup&&e._tooltipGroup.remove()}},dimple.plot.bubble={stacked:!1,supportedAxes:["x","y","z","c"],draw:function(e,t,n){var r=this,i=t._positionData,s=null,o="series"+e.series.indexOf(t);null!==e._tooltipGroup&&void 0!==e._tooltipGroup&&e._tooltipGroup.remove(),s=null===t.shapes||void 0===t.shapes?e._group.selectAll("."+o).data(i):t.shapes.data(i,function(e){return e.key}),s.enter().append("circle").attr("id",function(e){return e.key}).attr("class",function(e){return o+" bubble "+e.aggField.join(" ")+" "+e.xField.join(" ")+" "+e.yField.join(" ")+" "+e.zField.join(" ")}).attr("cx",function(n){return t.x._hasCategories()?dimple._helpers.cx(n,e,t):t.x._origin}).attr("cy",function(n){return t.y._hasCategories()?dimple._helpers.cy(n,e,t):t.y._origin}).attr("r",0).attr("opacity",function(n){return dimple._helpers.opacity(n,e,t)}).on("mouseover",function(n){r.enterEventHandler(n,this,e,t)}).on("mouseleave",function(){r.leaveEventHandler(e)}).call(function(){e.noFormats||this.attr("fill",function(n){return dimple._helpers.fill(n,e,t)}).attr("stroke",function(n){return dimple._helpers.stroke(n,e,t)})}),s.transition().duration(n).attr("cx",function(n){return dimple._helpers.cx(n,e,t)}).attr("cy",function(n){return dimple._helpers.cy(n,e,t)}).attr("r",function(n){return dimple._helpers.r(n,e,t)}).call(function(){e.noFormats||this.attr("fill",function(n){return dimple._helpers.fill(n,e,t)}).attr("stroke",function(n){return dimple._helpers.stroke(n,e,t)})}),s.exit().transition().duration(n).attr("r",0).attr("cx",function(n){return t.x._hasCategories()?dimple._helpers.cx(n,e,t):t.x._origin}).attr("cy",function(n){return t.y._hasCategories()?dimple._helpers.cy(n,e,t):t.y._origin}).each("end",function(){d3.select(this).remove()}),t.shapes=s},enterEventHandler:function(e,t,n,r){var i,s,o,u=5,a=10,f=750,l=d3.select(t),c=parseFloat(l.attr("cx")),h=parseFloat(l.attr("cy")),p=parseFloat(l.attr("r")),d=l.attr("opacity"),v=l.attr("fill"),m=r._dropLineOrigin(),g=d3.rgb(d3.rgb(v).r+.6*(255-d3.rgb(v).r),d3.rgb(v).g+.6*(255-d3.rgb(v).g),d3.rgb(v).b+.6*(255-d3.rgb(v).b)),y=d3.rgb(d3.rgb(v).r+.8*(255-d3.rgb(v).r),d3.rgb(v).g+.8*(255-d3.rgb(v).g),d3.rgb(v).b+.8*(255-d3.rgb(v).b)),b=[],w=0,E=0,S=0;null!==n._tooltipGroup&&void 0!==n._tooltipGroup&&n._tooltipGroup.remove(),n._tooltipGroup=n.svg.append("g"),n._tooltipGroup.append("circle").attr("cx",c).attr("cy",h).attr("r",p).attr("opacity",0).style("fill","none").style("stroke",v).style("stroke-width",1).transition().duration(f/2).ease("linear").attr("opacity",1).attr("r",p+4).style("stroke-width",2),null!==m.y&&n._tooltipGroup.append("line").attr("x1",c).attr("y1",h<m.y?h+p+4:h-p-4).attr("x2",c).attr("y2",h<m.y?h+p+4:h-p-4).style("fill","none").style("stroke",v).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",d).transition().delay(f/2).duration(f/2).ease("linear").attr("y2",h<m.y?m.y-1:m.y+1),null!==m.x&&n._tooltipGroup.append("line").attr("x1",c<m.x?c+p+4:c-p-4).attr("y1",h).attr("x2",c<m.x?c+p+4:c-p-4).attr("y2",h).style("fill","none").style("stroke",v).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",d).transition().delay(f/2).duration(f/2).ease("linear").attr("x2",c<m.x?m.x-1:m.x+1),i=n._tooltipGroup.append("g"),s=i.append("rect"),null!==r.categoryFields&&void 0!==r.categoryFields&&r.categoryFields.length>0&&r.categoryFields.forEach(function(t,n){b.push(t+(e.aggField[n]!==t?": "+e.aggField[n]:""))},this),r.x._hasTimeField()?b.push(r.x.timeField+": "+r.x._getFormat()(e.xField[0])):r.x._hasCategories()?r.x.categoryFields.forEach(function(t,n){b.push(t+(e.xField[n]!==t?": "+e.xField[n]:""))},this):b.push(r.x.measure+": "+r.x._getFormat()(e.cx)),r.y._hasTimeField()?b.push(r.y.timeField+": "+r.y._getFormat()(e.yField[0])):r.y._hasCategories()?r.y.categoryFields.forEach(function(t,n){b.push(t+(e.yField[n]!==t?": "+e.yField[n]:""))},this):b.push(r.y.measure+": "+r.y._getFormat()(e.cy)),null!==r.z&&void 0!==r.z&&b.push(r.z.measure+": "+r.z._getFormat()(e.zValue)),null!==r.c&&void 0!==r.c&&b.push(r.c.measure+": "+r.c._getFormat()(e.cValue)),b=b.filter(function(e,t){return b.indexOf(e)===t}),i.selectAll(".textHoverShapes").data(b).enter().append("text").text(function(e){return e}).style("font-family","sans-serif").style("font-size","10px"),i.each(function(){E=this.getBBox().width>E?this.getBBox().width:E,S=this.getBBox().width>S?this.getBBox().height:S}),i.selectAll("text").attr("x",0).attr("y",function(){return w+=this.getBBox().height,w-this.getBBox().height/2}),s.attr("x",-u).attr("y",-u).attr("height",Math.floor(w+u)-.5).attr("width",E+2*u).attr("rx",5).attr("ry",5).style("fill",y).style("stroke",g).style("stroke-width",2).style("opacity",.95),o=c+p+u+a+E>parseFloat(n.svg.attr("width")),i.attr("transform","translate("+(o?c-(p+u+a+E):c+p+u+a)+" , "+(h-(w-(S-u))/2)+")")},leaveEventHandler:function(e){null!==e._tooltipGroup&&void 0!==e._tooltipGroup&&e._tooltipGroup.remove()}},dimple.plot.line={stacked:!1,supportedAxes:["x","y","c"],draw:function(e,t,n){var r,i,s=this,o=t._positionData,u=[],a=[],f=1,l=!1;null!==e._tooltipGroup&&void 0!==e._tooltipGroup&&e._tooltipGroup.remove(),(t.x._hasCategories()||t.y._hasCategories())&&(f=0),o.forEach(function(e){var t,n=[],r=!1;for(t=f;t<e.aggField.length;t+=1)n.push(e.aggField[t]);a.forEach(function(e){r=r||e.join("/")===n.join("/")},this),r||a.push(n)},this),null!==t.c&&void 0!==t.c&&(t.x._hasCategories()&&t.y._hasMeasure()||t.y._hasCategories()&&t.x._hasMeasure())&&(l=!0,a.forEach(function(r){dimple._addGradient(r,"fill-line-gradient-"+r.join("_").replace(" ",""),t.x._hasCategories()?t.x:t.y,o,e,n,"fill")},this)),r=d3.svg.line().x(function(n){return dimple._helpers.cx(n,e,t)}).y(function(n){return dimple._helpers.cy(n,e,t)}),(null===t.shapes||void 0===t.shapes)&&(t.shapes=e._group.selectAll(".line").data(a).enter().append("svg:path").attr("opacity",function(t){return e.getColor(t).opacity})),t.shapes.data(a).transition().duration(n).attr("class",function(e){return"series line "+e.join("_").replace(" ","")}).attr("d",function(n){var i=[];return o.forEach(function(e){var t,r=!0;for(t=f;t<e.aggField.length;t+=1)r=r&&n[t-f]===e.aggField[t];r&&i.push(e)},this),i.sort(function(n,r){var i=0;return t.x._hasCategories()?i=dimple._helpers.cx(n,e,t)<dimple._helpers.cx(r,e,t)?-1:1:t.y._hasCategories()&&(i=dimple._helpers.cy(n,e,t)<dimple._helpers.cy(r,e,t)?-1:1),i}),1===i.length&&(u.push({cx:dimple._helpers.cx(i[0],e,t),cy:dimple._helpers.cy(i[0],e,t),opacity:e.getColor(n[n.length-1]).opacity,color:e.getColor(n[n.length-1]).stroke}),d3.select(this).remove()),r(i)}).call(function(){e.noFormats||this.attr("fill","none").attr("stroke",function(t){return l?"url(#fill-line-gradient-"+t.join("_").replace(" ","")+")":e.getColor(t[t.length-1]).stroke}).attr("stroke-width",t.lineWeight)}),i=e._group.selectAll(".markers").data(o).enter(),t.lineMarkers&&i.append("circle").transition().duration(n).attr("cx",function(n){return dimple._helpers.cx(n,e,t)}).attr("cy",function(n){return dimple._helpers.cy(n,e,t)}).attr("r",2+t.lineWeight).attr("fill","white").attr("stroke","none"),i.append("circle").on("mouseover",function(n){s.enterEventHandler(n,this,e,t)}).on("mouseleave",function(n){s.leaveEventHandler(n,this,e,t)}).transition().duration(n).attr("cx",function(n){return dimple._helpers.cx(n,e,t)}).attr("cy",function(n){return dimple._helpers.cy(n,e,t)}).attr("r",2+t.lineWeight).attr("opacity",function(n){return t.lineMarkers?e.getColor(n).opacity:0}).call(function(){e.noFormats||this.attr("fill","white").style("stroke-width",t.lineWeight).attr("stroke",function(n){return l?dimple._helpers.fill(n,e,t):e.getColor(n.aggField[n.aggField.length-1]).stroke})}),t.lineMarkers||e._group.selectAll(".fill").data(u).enter().append("circle").attr("cx",function(e){return e.cx}).attr("cy",function(e){return e.cy}).attr("r",t.lineWeight).attr("opacity",function(e){return e.opacity}).call(function(){e.noFormats||this.attr("fill",function(e){return e.color}).attr("stroke","none")})},enterEventHandler:function(e,t,n,r){var i,s,o,u=5,a=10,f=750,l=d3.select(t),c=parseFloat(l.attr("cx")),h=parseFloat(l.attr("cy")),p=parseFloat(l.attr("r")),d=dimple._helpers.opacity(e,n,r),v=l.attr("stroke"),m=r._dropLineOrigin(),g=d3.rgb(d3.rgb(v).r+.6*(255-d3.rgb(v).r),d3.rgb(v).g+.6*(255-d3.rgb(v).g),d3.rgb(v).b+.6*(255-d3.rgb(v).b)),y=d3.rgb(d3.rgb(v).r+.8*(255-d3.rgb(v).r),d3.rgb(v).g+.8*(255-d3.rgb(v).g),d3.rgb(v).b+.8*(255-d3.rgb(v).b)),b=0,w=0,E=0,S=[];null!==n._tooltipGroup&&void 0!==n._tooltipGroup&&n._tooltipGroup.remove(),n._tooltipGroup=n.svg.append("g"),l.style("opacity",1),n._tooltipGroup.append("circle").attr("cx",c).attr("cy",h).attr("r",p).attr("opacity",0).style("fill","none").style("stroke",v).style("stroke-width",1).transition().duration(f/2).ease("linear").attr("opacity",1).attr("r",p+r.lineWeight+2).style("stroke-width",2),null!==m.y&&n._tooltipGroup.append("line").attr("x1",c).attr("y1",h<m.y?h+p+r.lineWeight+2:h-p-r.lineWeight-2).attr("x2",c).attr("y2",h<m.y?h+p+r.lineWeight+2:h-p-r.lineWeight-2).style("fill","none").style("stroke",v).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",d).transition().delay(f/2).duration(f/2).ease("linear").attr("y2",h<m.y?m.y-1:m.y+1),null!==m.x&&n._tooltipGroup.append("line").attr("x1",c<m.x?c+p+r.lineWeight+2:c-p-r.lineWeight-2).attr("y1",h).attr("x2",c<m.x?c+p+r.lineWeight+2:c-p-r.lineWeight-2).attr("y2",h).style("fill","none").style("stroke",v).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",d).transition().delay(f/2).duration(f/2).ease("linear").attr("x2",c<m.x?m.x-1:m.x+1),i=n._tooltipGroup.append("g"),s=i.append("rect"),null!==r.categoryFields&&void 0!==r.categoryFields&&r.categoryFields.length>0&&r.categoryFields.forEach(function(t,n){S.push(t+(e.aggField[n]!==t?": "+e.aggField[n]:""))},this),r.x._hasTimeField()?S.push(r.x.timeField+": "+r.x._getFormat()(e.xField[0])):r.x._hasCategories()?r.x.categoryFields.forEach(function(t,n){S.push(t+(e.xField[n]!==t?": "+e.xField[n]:""))},this):r.x.useLog?S.push(r.x.measure+": "+e.cx):S.push(r.x.measure+": "+r.x._getFormat()(e.cx)),r.y._hasTimeField()?S.push(r.y.timeField+": "+r.y._getFormat()(e.yField[0])):r.y._hasCategories()?r.y.categoryFields.forEach(function(t,n){S.push(t+(e.yField[n]!==t?": "+e.yField[n]:""))},this):r.y.useLog?S.push(r.y.measure+": "+e.cy):S.push(r.y.measure+": "+r.y._getFormat()(e.cy)),null!==r.z&&void 0!==r.z&&S.push(r.z.measure+": "+r.z._getFormat()(e.zValue)),null!==r.c&&void 0!==r.c&&S.push(r.c.measure+": "+r.c._getFormat()(e.cValue)),S=S.filter(function(e,t){return S.indexOf(e)===t}),i.selectAll(".textHoverShapes").data(S).enter().append("text").text(function(e){return e}).style("font-family","sans-serif").style("font-size","10px"),i.each(function(){w=this.getBBox().width>w?this.getBBox().width:w,E=this.getBBox().width>E?this.getBBox().height:E}),i.selectAll("text").attr("x",0).attr("y",function(){return b+=this.getBBox().height,b-this.getBBox().height/2}),s.attr("x",-u).attr("y",-u).attr("height",Math.floor(b+u)-.5).attr("width",w+2*u).attr("rx",5).attr("ry",5).style("fill",y).style("stroke",g).style("stroke-width",2).style("opacity",.95),o=c+p+u+a+w>parseFloat(n.svg.attr("width")),i.attr("transform","translate("+(o?c-(p+u+a+w):c+p+u+a)+" , "+(h-(b-(E-u))/2)+")")},leaveEventHandler:function(e,t,n,r){d3.select(t).style("opacity",r.lineMarkers?dimple._helpers.opacity(e,n,r):0),null!==n._tooltipGroup&&void 0!==n._tooltipGroup&&n._tooltipGroup.remove()}},dimple._addGradient=function(e,t,n,r,i,s,o){var u=i._group.select("#"+t),a=[],f=n.position+"Field",l=!0,c=[];r.forEach(function(e){-1===a.indexOf(e[f])&&a.push(e[f])},this),a=a.sort(function(e,t){return n._scale(e)-n._scale(t)}),null===u.node()&&(l=!1,u=i._group.append("linearGradient").attr("id",t).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===n.position?n._scale(a[0])+i._widthPixels()/a.length/2:0).attr("y1","y"===n.position?n._scale(a[0])-i._heightPixels()/a.length/2:0).attr("x2","x"===n.position?n._scale(a[a.length-1])+i._widthPixels()/a.length/2:0).attr("y2","y"===n.position?n._scale(a[a.length-1])-i._heightPixels()/a.length/2:0)),a.forEach(function(t,n){var i={},s=0;for(s=0;s<r.length;s+=1)if(r[s].aggField.join("_")===e.join("_")&&r[s][f].join("_")===t.join("_")){i=r[s];break}c.push({offset:Math.round(100*(n/(a.length-1)))+"%",color:i[o]})},this),l?u.selectAll("stop").data(c).transition().duration(s).attr("offset",function(e){return e.offset}).attr("stop-color",function(e){return e.color}):u.selectAll("stop").data(c).enter().append("stop").attr("offset",function(e){return e.offset}).attr("stop-color",function(e){return e.color})},dimple._getOrderedList=function(e,t,n){var r=[],i=[],s=[],o=[t],u=[];return null!==n&&void 0!==n&&(u=u.concat(n)),u=u.concat({ordering:t,desc:!1}),u.forEach(function(t){var n;if("function"==typeof t.ordering)for(n in e[0])e[0].hasOwnProperty(n)&&-1===o.indexOf(n)&&o.push(n);else t.ordering instanceof Array||o.push(t.ordering)},this),r=dimple._rollUp(e,t,o),u.length>=1&&(u.forEach(function(e){var n=null===e.desc||void 0===e.desc?!1:e.desc,r=e.ordering,s=[],o="string"==typeof r?r:null,u=function(e){var t,n=0;for(t=0;t<e.length;t+=1){if(isNaN(e[t])){n=0;break}n+=parseFloat(e[t])}return n},a=function(e,t){var n=0,r=u(e),i=u(t);return isNaN(r)||0===r||isNaN(i)||0===i?isNaN(Date.parse(e[0]))||isNaN(Date.parse(t[0]))?e[0]<t[0]?n=-1:e[0]>t[0]&&(n=1):n=Date.parse(e[0])-Date.parse(t[0]):n=parseFloat(r)-parseFloat(i),n};"function"==typeof r?i.push(function(e,t){return(n?-1:1)*r(e,t)}):r instanceof Array?(r.forEach(function(e){s.push([].concat(e).join("|"))},this),i.push(function(e,r){var i,o,u="".concat(e[t]),a="".concat(r[t]);return i=s.indexOf(u),o=s.indexOf(a),i=0>i?n?-1:s.length:i,o=0>o?n?-1:s.length:o,(n?-1:1)*(i-o)})):i.push(function(e,t){var r=0;return void 0!==e[o]&&void 0!==t[o]&&(r=a([].concat(e[o]),[].concat(t[o]))),(n?-1:1)*r})}),r.sort(function(e,t){for(var n=0,r=0;n<i.length&&0===r;)r=i[n](e,t),n+=1;return r}),r.forEach(function(e){s.push(e[t])},this)),s},dimple._helpers={cx:function(e,t,n){var r=0;return r=null!==n.x.measure&&void 0!==n.x.measure?n.x._scale(e.cx):n.x._hasCategories()&&n.x.categoryFields.length>=2?n.x._scale(e.cx)+dimple._helpers.xGap(t,n)+(e.xOffset+.5)*(t._widthPixels()/n.x._max-2*dimple._helpers.xGap(t,n))*e.width:n.x._scale(e.cx)+t._widthPixels()/n.x._max/2},cy:function(e,t,n){var r=0;return r=null!==n.y.measure&&void 0!==n.y.measure?n.y._scale(e.cy):null!==n.y.categoryFields&&void 0!==n.y.categoryFields&&n.y.categoryFields.length>=2?n.y._scale(e.cy)-t._heightPixels()/n.y._max+dimple._helpers.yGap(t,n)+(e.yOffset+.5)*(t._heightPixels()/n.y._max-2*dimple._helpers.yGap(t,n))*e.height:n.y._scale(e.cy)-t._heightPixels()/n.y._max/2},r:function(e,t,n){var r=0;return r=null===n.z||void 0===n.z?5:n.z._hasMeasure()?n.z._scale(e.r):n.z._scale(t._heightPixels()/100)},xGap:function(e,t){var n=0;return(null===t.x.measure||void 0===t.x.measure)&&t.barGap>0&&(n=e._widthPixels()/t.x._max*(t.barGap>.99?.99:t.barGap)/2),n},xClusterGap:function(e,t,n){var r=0;return null!==n.x.categoryFields&&void 0!==n.x.categoryFields&&n.x.categoryFields.length>=2&&n.clusterBarGap>0&&!n.x._hasMeasure()&&(r=e.width*(t._widthPixels()/n.x._max-2*dimple._helpers.xGap(t,n))*(n.clusterBarGap>.99?.99:n.clusterBarGap)/2),r},yGap:function(e,t){var n=0;return(null===t.y.measure||void 0===t.y.measure)&&t.barGap>0&&(n=e._heightPixels()/t.y._max*(t.barGap>.99?.99:t.barGap)/2),n},yClusterGap:function(e,t,n){var r=0;return null!==n.y.categoryFields&&void 0!==n.y.categoryFields&&n.y.categoryFields.length>=2&&n.clusterBarGap>0&&!n.y._hasMeasure()&&(r=e.height*(t._heightPixels()/n.y._max-2*dimple._helpers.yGap(t,n))*(n.clusterBarGap>.99?.99:n.clusterBarGap)/2),r},x:function(e,t,n){var r=0;return r=n.x._hasTimeField()?n.x._scale(e.x)-dimple._helpers.width(e,t,n)/2:null!==n.x.measure&&void 0!==n.x.measure?n.x._scale(e.x):n.x._scale(e.x)+dimple._helpers.xGap(t,n)+e.xOffset*(dimple._helpers.width(e,t,n)+2*dimple._helpers.xClusterGap(e,t,n))+dimple._helpers.xClusterGap(e,t,n)},y:function(e,t,n){var r=0;return r=n.y._hasTimeField()?n.y._scale(e.y)-dimple._helpers.height(e,t,n)/2:null!==n.y.measure&&void 0!==n.y.measure?n.y._scale(e.y):n.y._scale(e.y)-t._heightPixels()/n.y._max+dimple._helpers.yGap(t,n)+e.yOffset*(dimple._helpers.height(e,t,n)+2*dimple._helpers.yClusterGap(e,t,n))+dimple._helpers.yClusterGap(e,t,n)},width:function(e,t,n){var r=0;return r=null!==n.x.measure&&void 0!==n.x.measure?Math.abs(n.x._scale(e.x<0?e.x-e.width:e.x+e.width)-n.x._scale(e.x)):n.x._hasTimeField()?n.x.floatingBarWidth:e.width*(t._widthPixels()/n.x._max-2*dimple._helpers.xGap(t,n))-2*dimple._helpers.xClusterGap(e,t,n)},height:function(e,t,n){var r=0;return r=n.y._hasTimeField()?n.y.floatingBarWidth:null!==n.y.measure&&void 0!==n.y.measure?Math.abs(n.y._scale(e.y)-n.y._scale(e.y<=0?e.y+e.height:e.y-e.height)):e.height*(t._heightPixels()/n.y._max-2*dimple._helpers.yGap(t,n))-2*dimple._helpers.yClusterGap(e,t,n)},opacity:function(e,t,n){var r=0;return r=null!==n.c&&void 0!==n.c?e.opacity:t.getColor(e.aggField.slice(-1)[0]).opacity},fill:function(e,t,n){var r=0;return r=null!==n.c&&void 0!==n.c?e.fill:t.getColor(e.aggField.slice(-1)[0]).fill},stroke:function(e,t,n){var r=0;return r=null!==n.c&&void 0!==n.c?e.stroke:t.getColor(e.aggField.slice(-1)[0]).stroke}},dimple._parentHeight=function(e){var t=e.offsetHeight;return(0>=t||null===t||void 0===t)&&(t=e.clientHeight),(0>=t||null===t||void 0===t)&&(t=null===e.parentNode||void 0===e.parentNode?0:dimple._parseYPosition(d3.select(e).attr("height"),e.parentNode)),t},dimple._parentWidth=function(e){var t=e.offsetWidth;return(0>=t||null===t||void 0===t)&&(t=e.clientWidth),(0>=t||null===t||void 0===t)&&(t=null===e.parentNode||void 0===e.parentNode?0:dimple._parseXPosition(d3.select(e).attr("width"),e.parentNode)),t},dimple._parseXPosition=function(e,t){var n=e;return void 0===e||null===e?n=0:isNaN(e)?"%"===e.slice(-1)?n=dimple._parentWidth(t)*(parseFloat(e.slice(0,e.length-1))/100):"px"===e.slice(-2)&&(n=parseFloat(e.slice(0,e.length-2))):n=e,n},dimple._parseYPosition=function(e,t){var n=e;return void 0===e||null===e?n=0:isNaN(e)?"%"===e.slice(-1)?n=dimple._parentHeight(t)*(parseFloat(e.slice(0,e.length-1))/100):"px"===e.slice(-2)&&(n=parseFloat(e.slice(0,e.length-2))):n=e,n},dimple._rollUp=function(e,t,n){var r=[];return t=null!==t&&void 0!==t?[].concat(t):[],e.forEach(function(e){var i=-1,s={},o=!0;r.forEach(function(n,r){-1===i&&(o=!0,t.forEach(function(t){o=o&&e[t]===n[t]},this),o&&(i=r))},this),-1!==i?s=r[i]:(t.forEach(function(t){s[t]=e[t]},this),r.push(s),i=r.length-1),n.forEach(function(n){-1===t.indexOf(n)&&(void 0===s[n]&&(s[n]=[]),s[n]=s[n].concat(e[n]))},this),r[i]=s},this),r},dimple.filterData=function(e,t,n){var r=e;return null!==t&&null!==n&&(null!==n&&void 0!==n&&(n=[].concat(n)),r=[],e.forEach(function(e){null===e[t]?r.push(e):n.indexOf([].concat(e[t]).join("/"))>-1&&r.push(e)},this)),r},dimple.getUniqueValues=function(e,t){var n=[];return null!==t&&void 0!==t&&(t=[].concat(t),e.forEach(function(e){var r="";t.forEach(function(t,n){n>0&&(r+="/"),r+=e[t]},this),-1===n.indexOf(r)&&n.push(r)},this)),n},dimple.newSvg=function(e,t,n){var r=null;if((null===e||void 0===e)&&(e="body"),r=d3.select(e),r.empty())throw"The '"+e+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return r.append("svg").attr("width",t).attr("height",n)}}();